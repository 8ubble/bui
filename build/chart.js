define("bui/chart",["bui/common","bui/chart/chart","bui/chart/axis","bui/chart/series","bui/chart/plotrange","bui/chart/theme"],function(require){var e=require("bui/common"),t=e.namespace("Chart");return e.mix(t,{Chart:require("bui/chart/chart"),Axis:require("bui/chart/axis"),Series:require("bui/chart/series"),PlotRange:require("bui/chart/plotrange"),Theme:require("bui/chart/theme")}),t}),define("bui/chart/actived",function(require){var e=require("bui/common"),t=function(){};return t.ATTRS={actived:{value:!1}},e.augment(t,{isActived:function(){return this.get("actived")},setActived:function(){this.setActiveStatus(!0),this.set("actived",!0)},setActiveStatus:function(){},clearActived:function(){this.setActiveStatus(!1),this.set("actived",!1),this.clearActivedItem&&this.clearActivedItem()}}),t}),define("bui/chart/activedgroup",function(){var e=function(){};return e.ATTRS={},BUI.augment(e,{isItemActived:function(e){return e.isActived()},getActiveItems:function(){return this.get("children")},setItemActived:function(e,t){t?e.setActived():e.clearActived()},onActived:function(e){this.fireUpGroup("actived",e)},onUnActived:function(e){this.fireUpGroup("unactived",e)},setActivedItem:function(e){var t=this;t.clearActivedItem(),e&&!t.isItemActived(e)&&(t.setItemActived(e,!0),t.onActived())},getActived:function(){var e=this,t=e.getActiveItems(),i=null;return BUI.each(t,function(t){return e.isItemActived(t)?(i=t,!1):void 0}),i},clearActivedItem:function(e){var t=this;e=e||t.getActived(),e&&(t.setItemActived(e,!1),t.onUnActived(e))}}),e}),define("bui/chart/showlabels",["bui/chart/labels"],function(require){var e=require("bui/common"),t=require("bui/chart/labels"),i=function(){};return i.ATTRS={labels:{}},e.augment(i,{renderLabels:function(){var e,i=this,r=i.get("labels");r&&(r.items||(r.items=[]),e=i.addGroup(t,r),i.set("labelsGroup",e))},resetLabels:function(t){var i=this,r=i.get("labels");if(r){var n=i.get("labelsGroup"),a=n.get("children"),s=a.length;t=t||r.items,e.each(t,function(e,t){if(s>t){var r=a[t];n.changeLabel(r,e)}else i.addLabel(e.text,e)});for(var o=s-1;o>=t.length;o--)a[o].remove()}},addLabel:function(e,t){var i,r=this,n=r.get("labelsGroup"),a={};return n&&(a.text=e,a.x=t.x,a.y=t.y,a.point=t,i=n.addLabel(a)),i},removeLabels:function(){var e=this,t=e.get("labelsGroup");t&&t.remove()}}),i}),define("bui/chart/labels",["bui/common","bui/chart/plotitem","bui/graphic"],function(require){var e=require("bui/common"),t=require("bui/chart/plotitem"),i=require("bui/graphic").Util,r="x-chart-labels",n=function(e){n.superclass.constructor.call(this,e)};return n.ATTRS={elCls:{value:r},zIndex:{value:6},items:{},label:{},renderer:{},animate:{value:!0},duration:{value:400}},e.extend(n,t),e.augment(n,{renderUI:function(){var e=this;n.superclass.renderUI.call(e),e._drawLabels()},addLabel:function(e){var t=this,i=t.get("items"),r=i.length;return i.push(e),t._addLabel(e,r)},_drawLabels:function(){var t=this,i=t.get("items");e.each(i,function(e,i){t._addLabel(e,i)})},_addLabel:function(e,t){var i=this,r=i._getLabelCfg(e,t);return i._createText(r)},_getLabelCfg:function(t,i){var r=this,n=r.get("label"),a=r.get("renderer");if(!e.isObject(t)){var s=t;t={},t.text=s}return a&&(t.text=a(t.text,t,i)),null==t.text&&(t.text=""),t.text=t.text.toString(),t.x=(t.x||0)+(n.x||0),t.y=(t.y||0)+(n.y||0),cfg=e.merge(n,t)},changeLabel:function(t,r){var n=this,a=e.Array.indexOf(t,n.get("children")),s=n._getLabelCfg(r,a);t&&(t.attr("text",s.text),(t.attr("x")!=s.x||t.attr("y")!=s.y)&&(i.svg&&n.get("animate")&&!s.rotate?(s.rotate&&t.attr("transform",""),t.animate({x:s.x,y:s.y},n.get("duration"))):(t.attr(s),s.rotate&&t.attr("transform",e.substitute("r{rotate} {x} {y}",s)))))},_createText:function(e){return this.addShape("label",e)}}),n}),define("bui/chart/legend",["bui/common","bui/chart/plotitem","bui/chart/legenditem"],function(require){var e=require("bui/common"),t=require("bui/chart/plotitem"),i=require("bui/chart/legenditem"),r=15,n=5,a=function(e){a.superclass.constructor.call(this,e)};return a.ATTRS={zIndex:{value:8},elCls:{value:"x-chart-legend"},items:{},layout:{value:"horizontal"},dx:{value:0},dy:{value:0},align:{value:"bottom"},back:{value:{stroke:"#909090",fill:"#fff"}}},e.extend(a,t),e.augment(a,{renderUI:function(){var e=this;a.superclass.renderUI.call(e),e._renderItems(),e._renderBorder()},bindUI:function(){a.superclass.bindUI.call(e);var e=this;e.on("mousemove",function(e){e.stopPropagation()})},_renderItems:function(){var t=this,i=t.get("items"),r=t.addGroup();t.set("itemsGroup",r),e.each(i,function(e,i){t._addItem(e,i)})},addItem:function(e){var t=this,i=t.get("items");t._addItem(e,i.length),t.resetBorder(),t.resetPosition()},_addItem:function(t){var r=this,n=r.get("itemsGroup"),a=r._getNextX(),s=r._getNextY(),o=e.mix({x:a,y:s},t);o.legend=r,n.addGroup(i,o)},_renderBorder:function(){var t,i,r,n,a=this,s=a.get("back");s&&(t=a._getTotalWidth(),i=a._getTotalHeight(),r=e.mix({r:5,width:t,height:i},s),n=a.addShape("rect",r),n.toBack(),a.set("borderShape",n))},resetBorder:function(){var e=this,t=e.get("borderShape");t&&t.attr({width:e._getTotalWidth(),height:e._getTotalHeight()})},resetPosition:function(){var e,t,i=this,r=i.get("align"),n=i.get("plotRange"),a=n.tl,s=n.br,o=i.get("dx"),c=i.get("dy"),u=i._getTotalWidth();switch(r){case"top":e=a.x,t=a.y;break;case"left":e=a.x-u,t=(a.y+s.y)/2;break;case"right":e=s.x,t=(a.y+s.y)/2;break;case"bottom":e=(a.x+s.x)/2-u/2,t=s.y}i.move(e+o,t+c)},_getCount:function(){return this.get("itemsGroup").get("children").length},_getNextX:function(){var t=this,i=t.get("layout"),r=n;if("horizontal"==i){var a=t.get("itemsGroup").get("children");e.each(a,function(e){e.isGroup&&(r+=e.getWidth()+n)})}return r},_getNextY:function(){var e=this,t=e.get("layout");return"horizontal"==t?n:r*e._getCount()+n},_getTotalWidth:function(){var t=this;if("horizontal"==t.get("layout"))return this._getNextX();var i=t.get("itemsGroup").get("children"),r=n;return e.each(i,function(e){var t=e.getWidth();e.isGroup&&t>r&&(r=t)}),r+2*n},_getTotalHeight:function(){var e=this,t=e._getNextY();return"horizontal"==e.get("layout")?r+2*n:t+n}}),a}),define("bui/chart/legenditem",["bui/common","bui/chart/plotitem"],function(require){var e=require("bui/common"),t=require("bui/chart/plotitem"),i=20,r=function(e){r.superclass.constructor.call(this,e)};return r.ATTRS={elCls:{value:"x-chart-legend-item"},label:{},legend:{},series:{},x:{},y:{},hideColor:{value:"#CCC"}},e.extend(r,t),e.augment(r,{renderUI:function(){var e=this;r.superclass.renderUI.call(e),e._createShape(),e._createMarker(),e._createLabel()},bindUI:function(){var e=this;r.superclass.bindUI.call(e),e.bindMouseEvent(),e.bindClick()},bindMouseEvent:function(){var e=this,t=e.get("series");e.on("mouseover",function(){t.setActived&&t.setActived()}).on("mouseout",function(){t.clearActived&&t.clearActived()})},bindClick:function(){var e=this,t=e.get("series");e.on("click",function(){var i=t.get("visible");if(i){var r=t.get("parent"),n=r.getVisibleSeries().length;if(1==n)return}e._setVisible(!i)})},_setVisible:function(e){var t=this,i=t.get("series"),r=t.get("shape"),n=t.get("marker"),a=e?i.get("color"):t.get("hideColor");e?i.get("parent").showSeries(i):i.get("parent").hideSeries(i),r&&r.attr({stroke:a,fill:a}),n&&n.attr({stroke:a,fill:a})},_getBySeries:function(e){var t=this,i=t.get("series");return i.get(e)},getWidth:function(){var e=this,t=e.get("label");return t.getBBox().width+i},_createLabel:function(){var e=this,t=e._getBySeries("name"),r=e.addShape("label",{x:i,"text-anchor":"start",y:7,cursor:"pointer",text:t});e.set("label",r)},_createShape:function(){var e,t=this,i=t._getBySeries("type"),r=t._getBySeries("color");switch(i){case"line":e=t.addShape("line",{x1:3,y1:7,x2:17,y2:7,stroke:r,"stroke-width":2});break;case"scatter":e=null;break;case"bubble":e=t.addShape("circle",{cx:10,cy:7,r:5,fill:r,stroke:r,"fill-opacity":.5});break;default:e=t.addShape("rect",{x:2,y:2,width:15,height:10,fill:r,stroke:r})}e&&e.attr("cursor","pointer"),t.set("shape",e)},_createMarker:function(){var t,i=this,r=i._getBySeries("markers");r&&(t=e.mix({},r.marker),t.radius=3,t.x=10,t.y=7,t=i.addShape("marker",t)),i.set("marker",t)}}),r}),define("bui/chart/markers",["bui/chart/plotitem","bui/graphic","bui/chart/activedgroup"],function(require){var e=require("bui/common"),t=require("bui/graphic").Util,i=require("bui/chart/activedgroup"),r=require("bui/chart/plotitem"),n=function(e){n.superclass.constructor.call(this,e)};return e.extend(n,r),e.mixin(n,[i]),n.ATTRS={elCls:{value:"x-chart-markers"},zIndex:{value:6},marker:{},actived:{},single:{value:!1},xCache:{value:[],shared:!1}},e.augment(n,{renderUI:function(){var e=this;n.superclass.renderUI.call(e),e._drawMarkers()},isItemActived:function(e){return e.get("actived")},setItemActived:function(e,t){var i=this,r=i.get("marker"),n=i.get("actived"),a=i.get("single");t?(e.attr(n),e.set("actived",!0),a&&!e.get("visible")&&e.show()):(e.attr(r),e.set("actived",!1),a&&e.hide())},change:function(i){var r=this,n=r.get("children"),a=[];if(!r.get("single")){r.set("items",i),e.each(i,function(e,i){var s=n[i];s?(t.svg?s.animate({x:e.x,y:e.y},400):s.attr(e),a.push(e.x)):r._addMarker(e)});for(var s=r.getCount(),o=s-1;o>i.length-1;o--)r.getChildAt(o).remove();r.set("xCache",a)}},_drawMarkers:function(){var t=this,i=t.get("single"),r=t.get("items");i&&(r=[{x:0,y:0,visible:!1}]),e.each(r,function(e){t._addMarker(e)})},addMarker:function(e){return this._addMarker(e)},_addMarker:function(t){var i=this,r=i.get("xCache"),n=i.get("marker"),a=e.merge(n,t);return r.push(parseInt(t.x)),i.addShape("marker",a)},getSnapMarker:function(i,r){var n,a=this,s=a.get("xCache"),o=a.get("single");if(o)return a.getChildAt(0);if(e.isObject(i)){var c=a.get("children");e.each(c,function(e){return e.attr("x")==i.x&&e.attr("y")==i.y?(n=e,!1):void 0})}else{var u=t.snapTo(s,i,r),l=e.Array.indexOf(u,s);n=a.getChildAt(l)}return n}}),n}),define("bui/chart/plotback",["bui/common","bui/chart/plotitem"],function(require){var e=require("bui/common"),t=require("bui/chart/plotitem"),i=require("bui/chart/plotrange"),r=function(e){r.superclass.constructor.call(this,e)};return r.ATTRS={elCls:{value:"x-chart-back"},zIndex:{value:0},margin:{value:20},plotRange:{},background:{},border:{}},e.extend(r,t),e.augment(r,{beforeRenderUI:function(){r.superclass.beforeRenderUI.call(this),this._calculateRange()},renderUI:function(){r.superclass.renderUI.call(this),this._renderBorder(),this._renderBackground()},_renderBorder:function(){var t,i=this,r=i.get("border"),n=i.get("canvas");r&&(t=e.mix({width:n.get("width"),height:n.get("height")},r),this.addShape("rect",t))},_renderBackground:function(){var t,i,r,n,a=this,s=a.get("background"),o=a.get("plotRange");s&&(t=o.getWidth(),i=o.getHeight(),r=o.tl,n={x:r.x,y:r.y,width:t,height:i},s.image?(n.src=s.image,a.addShape("image",n)):(e.mix(n,s),a.addShape("rect",n)))},_calculateRange:function(){var t,r,n,a=this,s=a.get("margin"),o=a.get("canvas"),c=o.get("width"),u=o.get("height"),l=0,g=0,h=0,f=0;e.isNumber(s)&&(l=g=h=f=s),e.isArray(s)&&(l=s[0],h=null!=s[1]?s[1]:s[0],f=null!=s[2]?s[2]:s[0],g=null!=s[3]?s[3]:h),r=o.getRelativePoint(g,u-f),n=o.getRelativePoint(c-h,l),t=new i(r,n),a.set("plotRange",t)}}),r}),define("bui/chart/plotitem",["bui/common","bui/graphic"],function(require){function e(t){if(!t._attrs&&t!=r.Group){var n=t.superclass.constructor;n&&!n._attrs&&e(n),t._attrs={},i.mixAttrs(t._attrs,n._attrs),i.mixAttrs(t._attrs,t.ATTRS)}}function t(i){e(this.constructor),t.superclass.constructor.call(this,i)}var i=require("bui/common"),r=require("bui/graphic");return t.ATTRS={itemName:{value:"item"},groupName:{value:""}},i.extend(t,r.Group),i.augment(t,{getDefaultCfg:function(){var e=this,t=e.constructor,r=t._attrs,n={};for(var a in r)if(r.hasOwnProperty(a)){var s=r[a],o=s.value;null!=o&&(s.shared===!1?(i.isObject(o)&&(n[a]={}),i.isArray(o)&&(n[a]=[]),i.mixAttr(n[a],o)):n[a]=o)}return n},fireUp:function(e,t){var i=this,r=i.get("canvas"),n=r.chart;n&&(t.target=t.target||n,n.fire(e,t))},fireUpGroup:function(e,t,i){var r=this,n=r.get("itemName"),a=r.get("groupName");i=i||{},i[n]=t,a&&(i[a]=r.get("parent")),r.fireUp(n.toLowerCase()+e,i)}}),t}),define("bui/chart/plotrange",function(){function e(e,t){return e>t?t:e}function t(e,t){return e>t?e:t}function i(e,t){this.start=e,this.end=t,this.init()}return BUI.augment(i,{init:function(){var i=this;start=i.start,end=i.end;var r=i.tl={};r.x=e(start.x,end.x),r.y=e(start.y,end.y);var n=i.tr={};n.x=t(start.x,end.x),n.y=e(start.y,end.y);var a=i.bl={};a.x=e(start.x,end.x),a.y=t(start.y,end.y);var s=i.br={};s.x=t(start.x,end.x),s.y=t(start.y,end.y);var o=i.cc={};o.x=(s.x-r.x)/2+r.x,o.y=(s.y-r.y)/2+r.y},isInRange:function(e,t){BUI.isObject(e)&&(t=e.y,e=e.x);var i=this,r=i.tl,n=i.br;return e>=r.x&&e<=n.x&&t>=r.y&&t<=n.y},isInVertical:function(e){BUI.isObject(e)&&(e=e.y);var t=this,i=t.tl,r=t.br;return e>=i.y&&e<=r.y},isInHorizontal:function(e){BUI.isObject(e)&&(e=e.x);var t=this,i=t.tl,r=t.br;return e>=i.x&&e<=r.x},getWidth:function(){var e=this.tl,t=this.br;return t.x-e.x},getHeight:function(){var e=this.tl,t=this.br;return t.y-e.y}}),i}),define("bui/chart/theme",function(e){var t=e("bui/common"),i=function(e,t){return i.initTheme(e,t)};i.initTheme=function(e,i){return t.mix(!0,{},e,i)};var r={duration:1e3,line:{"stroke-width":2,"stroke-linejoin":"round","stroke-linecap":"round"},lineActived:{"stroke-width":3},markers:{marker:{radius:3},actived:{radius:6,stroke:"#fff"}},animate:!0};return i.Origin=i({plotCfg:{margin:[50]},title:{"font-size":"16px","font-family":"SimSun,Georgia, Times, serif",fill:"#274b6d"},subTitle:{"font-size":14,"font-family":"tahoma,arial,SimSun,Georgia, Times, serif",fill:"#4d759e"},xAxis:{labels:{label:{y:12}}},yAxis:{line:null,tickLine:null,grid:{line:{stroke:"#c0c0c0"}},title:{text:"",rotate:-90,x:-30},position:"left",labels:{label:{x:-12}}},legend:{dy:30},seriesOptions:{lineCfg:r,areaCfg:r,bubbleCfg:{circle:{"stroke-width":1,"fill-opacity":.5},activeCircle:{"stroke-width":2}},pieCfg:{colors:["#5e90c9","#1c2d3f","#a9d052","#a12d2d","#43bbb4","#5a2a94","#fabe3c","#2279dc","#e360e5","#48000c"],item:{stroke:"#fff"},labels:{distance:30,label:{}}}},tooltip:{}}),i.Base=i.initTheme(i.Origin,{colors:["#5e90c9","#1c2d3f","#a9d052","#a12d2d","#43bbb4","#5a2a94","#fabe3c","#2279dc","#e360e5","#48000c"],symbols:["circle","diamond","square","triangle","triangle-down"],plotCfg:{margin:[50,50,100]},seriesOptions:{pieCfg:{colors:["#5e90c9","#1c2d3f","#a9d052","#a12d2d","#43bbb4","#5a2a94","#fabe3c","#2279dc","#e360e5","#48000c"]}}}),i.SmoothBase=i.initTheme(i.Origin,{title:{fill:"#444"},subTitle:{fill:"#999"},xAxis:{line:{"stroke-width":1,stroke:"#a7a7a7"},tickLine:{stroke:"#a7a7a7","stroke-width":1,value:5},labels:{label:{y:12,fill:"#444"}}},yAxis:{grid:{line:{stroke:"#a7a7a7","stroke-dasharray":"."}},title:{text:"",rotate:-90,x:-30,fill:"#444"},position:"left",labels:{label:{x:-12,fill:"#444"}}},plotCfg:{margin:[50,50,100]},colors:["#00a3d7","#6ebb46","#f6c100","#ff6a00","#e32400","#423ba8"],symbols:["circle","diamond","square","triangle","triangle-down"],seriesOptions:{pieCfg:{colors:["#00a3d7","#6ebb46","#f6c100","#ff6a00","#e32400","#423ba8"]}},tooltip:{offset:10,title:{"font-size":"10","text-anchor":"start",x:5,y:15,fill:"#444"},value:{"font-size":"12","font-weight":"normal","text-anchor":"start",fill:"#444"},crossLine:{stroke:"#a7a7a7"}}}),i.Smooth1=i.initTheme(i.SmoothBase),i.Smooth2=i.initTheme(i.SmoothBase,{colors:["#7179cb","#4dceff","#79c850","#ffb65d","#fc694b","#9a9792"],seriesOptions:{pieCfg:{colors:["#7179cb","#4dceff","#79c850","#ffb65d","#fc694b","#9a9792"]}}}),i.Smooth3=i.initTheme(i.SmoothBase,{colors:["#40a00e","#444444","#85cc82","#5e5e64","#60b336","#89847f"],seriesOptions:{pieCfg:{colors:["#40a00e","#444444","#85cc82","#5e5e64","#60b336","#89847f"]}}}),i.Smooth4=i.initTheme(i.SmoothBase,{colors:["#e1c673","#c49756","#8c6c42","#595348","#c86c4b","#7c4f34"],seriesOptions:{pieCfg:{colors:["#e1c673","#c49756","#8c6c42","#595348","#c86c4b","#7c4f34"]}}}),i.Smooth5=i.initTheme(i.SmoothBase,{colors:["#89847f","#aea9a2","#606060","#232323","#d8d2c7","#444444"],seriesOptions:{pieCfg:{colors:["#89847f","#aea9a2","#606060","#232323","#d8d2c7","#444444"]}}}),i.Smooth6=i.initTheme(i.SmoothBase,{colors:["#ff9d40","#89847f","#ff8127","#b4aea7","#ffba66","#606060"],seriesOptions:{pieCfg:{colors:["#ff9d40","#89847f","#ff8127","#b4aea7","#ffba66","#606060"]}}}),i.Smooth7=i.initTheme(i.SmoothBase,{colors:["#25b0dd","#7fdcff","#30b2c8","#5dc5ee","#266796","#258bca"],seriesOptions:{pieCfg:{colors:["#25b0dd","#7fdcff","#30b2c8","#5dc5ee","#266796","#258bca"]}}}),i}),define("bui/chart/tooltip",["bui/common","bui/graphic","bui/chart/plotitem"],function(require){function e(e,t){return e>t?e:t}var t=require("bui/common"),i=require("bui/chart/plotitem"),r=require("bui/graphic").Util,n=function(e){n.superclass.constructor.call(this,e)};return n.ATTRS={zIndex:{value:10},elCls:{value:"x-chart-tootip"},crosshairs:{value:!1},plotRange:{},shared:{value:!1},offset:{value:0},shadow:{},title:{value:{"font-size":"10","text-anchor":"start",x:5,y:15}},name:{value:{"font-size":"12","text-anchor":"start"}},value:{value:{"font-size":"12","font-weight":"bold","text-anchor":"start"}},border:{value:{x:0,y:0,r:3,fill:"#fff","fill-opacity":.85}},animate:{value:!0},duration:{value:100},pointRenderer:{},valueSuffix:{value:""},visible:{value:!1},items:[],crossLine:{value:{stroke:"#C0C0C0"}}},t.extend(n,i),t.augment(n,{renderUI:function(){var e=this;n.superclass.renderUI.call(e),e._renderBorer(),e._renderText(),e._renderItemGroup(),e._renderCrossLine()},_renderBorer:function(){var e=this,t=(e.getBBox(),e.addShape("rect",e.get("border")));e.set("borderShape",t)},_renderText:function(){var e=this,t=e.get("title");e.setTitle(t.text)},_renderItemGroup:function(){var e=this,t=e.get("items"),i=e.addGroup({x:8,y:30});e.set("textGroup",i),t&&e.setItems(t)},_renderCrossLine:function(){var e,t=this,i=t.get("crosshairs"),r=t.get("plotRange");i&&(e=t.get("parent").addShape({type:"line",visible:!1,zIndex:3,attrs:{stroke:t.get("crossLine").stroke,x1:0,y1:r.bl.y,x2:0,y2:r.tl.y}}),t.set("crossShape",e))},setTitle:function(e){var t=this,i=t.get("titleShape"),r=t.get("title");i||(r.text=e||"",i=t.addShape("text",r),t.set("titleShape",i)),i.attr("text",e)},getInnerBox:function(){var e=this,t=e.get("textGroup"),i=e.get("titleShape"),r=t.getBBox(),n={},a=r.width;if(i){var s=i.getBBox();a=Math.max(a,s.width)}return n.width=r.x+a+8,n.height=r.height+r.y+10,n},setColor:function(e){var t=this,i=t.get("borderShape");i.attr("stroke",e)},show:function(){var e=this,t=e.get("crossShape"),i=e.get("hideHandler");i&&clearTimeout(i),n.superclass.show.call(e),t&&t.show()},hide:function(){var e=this,t=e.get("crossShape"),i=setTimeout(function(){n.superclass.hide.call(e),e.set("hideHandler",null)},e.get("duration"));e.set("hideHandler",i),t&&t.hide()},setPosition:function(t,i){var n=this,a=n.get("plotRange"),s=n.get("offset"),o=n.get("crossShape"),c=n.getBBox(),u=!0,l=n.get("animate"),g=t;t=t-c.width-s,i-=c.height,a&&(a.isInRange(t,i)||(a.isInVertical(i)||(i=a.tl.y),a.isInHorizontal(t)||(t=e(a.tl.x,g)+s,u=!1))),(n.get("x")!=t||n.get("y")!=i)&&(l&&r.svg&&n.get("visible")&&n.animate({x:t,y:i},n.get("duration")),n.move(t,i),o&&(u?o.attr("transform","t"+g+" 0"):o.attr("transform","t"+(t-s)+" 0")))},resetBorder:function(){var e=this,t=e.getInnerBox(),i=e.get("borderShape");i.attr({width:t.width,height:t.height})},addItem:function(e,i){function r(e,i){var r=t.merge(u,{x:f,y:l,text:e},i);return o.addShape("text",r)}var n,a=this,s=a.get("textGroup"),o=s.addGroup(),c=a.get("name"),u=a.get("value"),l=16*i;n=t.merge(c,{x:0,y:l,text:e.name+":",fill:e.color});var g,h=o.addShape("text",n),f=h.getBBox().width+10,d=a.get("valueSuffix");t.isArray(e.value)?t.each(e.value,function(e){var i;i=t.isObject(e)?r(e.text,e):r(e),f+=i.getBBox().width}):(g=d?e.value+" "+d:e.value,r(g))},setItems:function(e){var i=this;i.clearItems(),t.each(e,function(e,t){i.addItem(e,t)}),e[0]&&i.setColor(e[0].color),i.resetBorder()},clearItems:function(){var e=this,t=e.get("textGroup");t.clear()},remove:function(){var e=this,t=e.get("crossShape");t&&t.remove(),n.superclass.remove(this)}}),n}),define("bui/chart/abstractaxis",function(require){var e=require("bui/common"),t=require("bui/chart/plotitem"),i=require("bui/chart/grid"),r=require("bui/graphic").Util,n=require("bui/chart/showlabels"),a="x-chart-axis",s=function(e){s.superclass.constructor.call(this,e)};return s.ATTRS={ticks:{},plotRange:{},line:{},tickLine:{},grid:{},labels:{},autoPaint:{value:!0},formatter:{}},e.extend(s,t),e.mixin(s,[n]),e.augment(s,{beforeRenderUI:function(){s.superclass.beforeRenderUI.call(this),this.set("pointCache",[])},renderUI:function(){var e=this;s.superclass.renderUI.call(e),e.renderLabels(),e.get("title")&&e._renderTitle(),e.get("autoPaint")&&e.paint()},paint:function(){var e=this;e._drawLines(),e._renderTicks(),e._renderGrid()},_renderTitle:function(){},_renderGrid:function(){var e,t=this,r=t.get("grid");r&&(e=t.get("parent").addGroup(i,r),t.set("gridGroup",e))},isInAxis:function(e,t){var i=this,r=i.get("plotRange");return r&&r.isInRange(e,t)},getLinePath:function(){},getOffsetPoint:function(){},getValue:function(){},getSnapValue:function(e){var t=this,i=t.get("pointCache");return r.snapTo(i,e)},getTicksCount:function(){return this.get("ticks").length},getTickOffsetPoint:function(e){return this.getOffsetPoint(e)},getOffsetByIndex:function(){},_drawLines:function(){var t,i=this,r=i.get("line"),n=i.get("ticks");if(r){t=i.getLinePath(),r=e.mix({path:t},r);var s=i.addShape({type:"path",elCls:a+"-line",attrs:r});i.set("lineShape",s)}i._processTicks(n)},_processTicks:function(t,i){var r=this,n=r.get("pointCache"),a=r.get("labels");t=t||r.get("ticks"),e.each(t,function(e,t){var s=r.getTickOffsetPoint(t),o=r.getOffsetPoint(t),c=r.getOffsetByIndex(t);n.push(c),r.get("tickLine")&&r._addTickItem(s,c),r.get("grid")&&r._addGridItem(s),a&&(i?a.items.push({text:r.formatPoint(e),x:o.x,y:o.y}):r.addLabel(r.formatPoint(e),o,c))})},_renderTicks:function(){var t=this,i=t.get("tickItems"),r=t.get("tickLine"),n="",s=e.mix({},r);if(i){e.each(i,function(t){var i=e.substitute("M{x1} {y1}L{x2} {y2}",t);n+=i}),delete s.value,s.path=n;var o=t.addShape({type:"path",elCls:a+"-ticks",attrs:s});t.set("tickShape",o)}},_addTickItem:function(t,i){var r=this,n=r.get("tickItems"),a={x1:t.x,y1:t.y},s=r.getTickEnd(a,i);n||(n=[],r.set("tickItems",n)),e.mix(a,s),n.push(a)},getTickEnd:function(){},formatPoint:function(e){var t=this,i=t.get("formatter");return i&&(e=i.call(this,e)),e},_addGridItem:function(t){var i,r=this,n=r.get("grid"),a=(r.get("plotRange"),{});n.items||(n.items=[]),i=r.getGridItemCfg(t),e.mix(a,i),n.items.push(a)},getGridItemCfg:function(){},remove:function(){{var e=this,t=e.get("gridGroup");e.get("labelsGroup")}t&&t.remove(),e.removeLabels(),s.superclass.remove.call(this)}}),s}),define("bui/chart/baseaxis",["bui/common","bui/graphic","bui/chart/abstractaxis"],function(require){function e(t){e.superclass.constructor.call(this,t)}var t=require("bui/common"),i=require("bui/chart/abstractaxis"),r=require("bui/graphic").Util,n="x-chart-axis";return e.ATTRS={zIndex:{value:4},x:{},y:{},start:{},end:{},tickOffset:{value:0},elCls:{value:n},position:{value:"bottom"},line:{value:{"stroke-width":1,stroke:"#C0D0E0"}},tickLine:{value:{"stroke-width":1,stroke:"#C0D0E0",value:5}}},t.extend(e,i),t.augment(e,{beforeRenderUI:function(){var t,i=this;if(e.superclass.beforeRenderUI.call(i),t=i.get("plotRange")){var r=t.start,n=i.get("position"),a={};i.isVertical()?"left"==n?(a.y=t.end.y,a.x=r.x):(r={},a=t.end,r.x=t.end.x,r.y=t.start.y):(a.x=t.end.x,a.y=r.y),i.set("start",r),i.set("end",a)}i.set("indexCache",{}),i.set("pointCache",[])},change:function(e){var t=this;t.isChange(e.ticks)&&(t._clearTicksInfo(),t.changeInfo(e),t._processTicks(null,!0),t._changeTicks(),t._changeGrid(),t.resetLabels())},isChange:function(e){var i=this,r=i.get("ticks");return!t.Array.equals(e,r)},changeInfo:function(e){var t=this;t.set("ticks",e.ticks)},_clearTicksInfo:function(){var e=this,t=e.get("grid"),i=e.get("labels");e.set("pointCache",[]),e.set("indexCache",[]),e.set("tickItems",[]),t&&(t.items=[]),i&&(i.items=[])},paint:function(){var e=this;e._drawLines(),e._renderTicks(),e._renderGrid()},isVertical:function(){var e,t=this,i=t.get("isVertical");return null!=i?i:(e=t.get("position"),i="bottom"==e||"top"==e?!1:!0,t.set("isVertical",i),i)},getOffset:function(e){var i=this,r=i.get("ticks"),n=t.Array.indexOf(e,r);return i.getOffsetByIndex(n)},getStartOffset:function(){return this._getStartCoord()},getEndOffset:function(){return this._getEndCoord()},getValue:function(e){var t=this,i=t._getStartCoord(),r=t._getEndCoord();return i>e||e>r?0/0:t.parseOffsetValue(e)},getStartValue:function(){var e=this,t=e.get("ticks");return t[0]},getEndValue:function(){var e=this,t=e.get("ticks");return t[t.length-1]},getSnapIndex:function(e){var i=this,n=i.get("pointCache"),a=r.snapTo(n,e);return t.Array.indexOf(a,n)},_appendEndOffset:function(e){var t,i=this,r=i.get("tickOffset");return"number"!=typeof r&&(r=r[0]),r&&(t=i._getDirectFactor(),0==e?e+=r*t:e>0?e+=r:e-=r),e},getOffsetByIndex:function(e){var t=this,i=t._getLength(),r=t.get("ticks"),n=r.length,a=i/(n-1)*e;return t._appendEndOffset(a)+t._getStartCoord()},getOffsetPoint:function(e,t){var i=this,r=i._getOrthoCoord(),n=i.get("indexCache");return t||(void 0!==n[e]?t=n[e]:(t=i.getOffsetByIndex(e),n[e]=t)),i.isVertical()?{x:r,y:t}:{x:t,y:r}},getTickOffsetPoint:function(e){return this.getOffsetPoint(e)},_getStartCoord:function(){var e=this,t=e.get("start");return e.isVertical()?t.y:t.x},_getOrthoCoord:function(){var e=this,t=e.get("start");return e.isVertical()?t.x:t.y},_getEndCoord:function(){var e=this,t=e.get("end");return e.isVertical()?t.y:t.x},_getMiddleCoord:function(){var e=this,t=e._getStartCoord(),i=e._getLength();return t+e._appendEndOffset(i/2)},getLength:function(){return Math.abs(this._getLength())},getTickAvgLength:function(){var e=this,t=e.get("ticks");return e.getLength()/(t.length-1)},_getLength:function(){var e,t=this,i=t.get("start"),r=t.get("tickOffset"),n=t.get("end");return r="number"!=typeof r?r[0]+r[1]:2*r,e=t.isVertical()?n.y-i.y:n.x-i.x,e>0?e-=r:e+=r,e},getLinePath:function(){var e=this,t=e.get("start"),i=e.get("end"),r=[];return r.push(["M",t.x,t.y]),r.push(["L",i.x,i.y]),r},getTickEnd:function(e){var t=this,i=t.get("tickLine"),r=t._getAlignFactor(),n=i.value,a={};return t.isVertical()?(a.x2=e.x1+n*r,a.y2=e.y1):(a.x2=e.x1,a.y2=e.y1+n*r),a},_changeTicks:function(){var e=this,i=e.get("tickShape"),n=e.get("tickItems"),a="";return i?(t.each(n,function(e){var i=t.substitute("M{x1} {y1}L{x2} {y2}",e);a+=i}),void r.animPath(i,a,2)):void(n&&n.length&&e._renderTicks())},_getDirectFactor:function(){var e,t,i,r=this,n=r.get("directfactor");return n?n:(n=1,e=r.get("position"),t=r.get("start"),i=r.get("end"),"bottom"==e||"top"==e?t.x>i.x&&(n=-1):t.y>i.y&&(n=-1),r.set("directfactor",n),n)},_getAlignFactor:function(){var e,t=this,i=t.get("factor");return i?i:(e=t.get("position"),i="bottom"==e||"right"==e?1:-1,t.set("factor",i),i)},_renderTitle:function(){var e=this,i=e.get("title"),r=e._getMiddleCoord(),a=e.getOffsetPoint(null,r),s=t.mix({},i);i.text&&(s.x=a.x+(i.x||0),s.y=a.y+(i.y||0),e.addShape({type:"label",elCls:n+"-title",attrs:s}))},getGridItemCfg:function(e){var t=this,i={},r=t.get("plotRange");return i.x1=e.x,i.y1=e.y,t.isVertical()?(i.y2=i.y1,i.x2=r.end.x):(i.x2=i.x1,i.y2=r.end.y),i},_changeGrid:function(){var e,t=this,i=t.get("grid");i&&(e=t.get("gridGroup"),e&&e.change(i.items))},remove:function(){{var t=this,i=t.get("gridGroup");t.get("labelsGroup")}i&&i.remove(),t.removeLabels(),e.superclass.remove.call(this)}}),e}),define("bui/chart/axis/auto",["bui/graphic"],function(require){function e(e){return null==e}function t(e){var t=1;if(1e-6>e)return t;for(;e>10;)t=10*t,e/=10;for(;1>e;)t/=10,e=10*e;return t}function i(e,i,n){n=n||y;var a=n==y?!1:!0,s=1;0>e&&(s=-1),e*=s;var o=t(e);return s*=o,e/=o,e=a?r(n,e):i&&s>0?x.snapFloor(n,e):x.snapCeiling(n,e),e*s}function r(e,t){for(var i=t,r=t,n=t,a=1;a<e.length;a++){var s=e[a];if(s>t){i=s;break}r=s}return n=Math.abs(r-t)<Math.abs(i-t)?r:i}function n(e,t,i){if(i)var r=Math.ceil(e/t,10);else var r=Math.floor(e/t,10);return r*t}function a(e,t){var i=t.toString(),r=i.indexOf(".");if(-1==r)return e;var n=i.substr(r+1).length;return parseFloat(e.toFixed(n))}function s(e){for(var t,t,i=e[0],r=e[0],n=e[0],a=e.length,s=0,o=1;a>o;o++){var c=e[o];c>i&&(i=c),r>c&&(r=c),n+=c}t=n/a;for(var o=0;a>o;o++)s+=Math.abs(e[o]-t);return s/=a,r==i&&(r>0?r=0:i=0),{max:i,min:r,avg:t,deviation:s}}function o(e,t,i){var r=[];return b.isArray(e[0])?i?b.each(e[0],function(t,i){for(var n=t,a=1;a<e.length;a++)n+=e[a][i];r.push(n)}):b.each(e,function(e){r=r.concat(e)}):r=e,t&&(r=$.map(r,t)),s(r)}function c(e){return e=new Date(e),b.Date.getDate(e).getTime()}function u(e){e=new Date(e);var t=b.Date.getDate(e);return b.Date.isDateEquals(e,t)||(t=b.Date.addDay(1,t)),t.getTime()}function l(e){return new Date(e).getFullYear()}function g(e){return new Date(e,0,1).getTime()}function h(e){return new Date(e).getMonth()}function f(e,t){var i=l(e),r=l(t),n=h(e),a=h(t);return 12*(r-i)+(a-n)%12}function d(e,t){return new Date(e,t,1).getTime()}function v(e,t){return Math.ceil((t-e)/T)}function p(e,t){return Math.ceil((t-e)/C)}function m(e,t){return Math.ceil((t-e)/60*1e3)}var b=require("bui/common"),x=require("bui/graphic").Util,y=[0,1,1.5,2,2.5,3,4,5,6,8,10],k=[0,1,2.5,5,10],A=5,I=7,_={};_.caculate=function(t,r){var s,c=t.min,u=t.max,l=t.data,g=t.interval,h=[],f=t.minCount||A,d=t.maxCount||I,v=(f+d)/2,p=!1;if(r&&("none"!=r&&(p=!0),"percent"==r&&(c=0,u=100,g=25)),e(c)||e(u)||e(g)){var m=o(l,null,p);if(e(u)&&(u=m.max+.05*(m.max-m.min)),e(c)&&(c=m.min),e(g)){var b=(u-c)/v;g=m.deviation>b?i(b,!0,k):m.deviation?i(m.deviation,!0,k):i(b,!0,k),s=parseInt((u-c)/g,10),s>d&&(s=d),f>s&&(s=f),g=i((u-c)/s,!0,k),u=n(u,g,!0),c=n(c,g),s=(u-c)/g}}e(s)&&(s=(u-c)/g),c=a(c,g),e(c)||h.push(c);for(var x=1;s>=x;x++)h.push(a(g*x+c,g));return{min:c,max:a(u,g),interval:g,count:s,ticks:h,info:m}},_.Time={};var S=6e4,C=36e5,T=864e5;return _.Time.caculate=function(t){var i,r=t.min,n=t.max,s=t.data,x=t.interval,y=[];if(e(r)||e(n)||e(x)){var k=o(s,function(e){return b.isDate(e)&&(e=e.getTime()),b.isString(e)&&(e=e.replace(/-/gi,"/"),e=new Date(e)),e});if(e(n)&&(n=k.max),e(r)&&(r=k.min),n-r>T&&(r=c(r),n=u(n)),n==r)throw"max not  equal to min";if(e(x)){var A,I,_=n-r,P=T,L=365*P;x=parseInt(_/(t.maxCount||8)),A=x/L;var M=l(r);if(A>.51){I=Math.ceil(A),x=I*L;for(var w=l(n),O=M;w+I>O;O+=I)y.push(g(O));x=null}else if(A>.0834){for(var I=l(r),R=Math.floor(A/.0834),G=h(r),B=f(r,n),O=0;B+R>=O;O+=R)y.push(d(M,O+G));x=null}else if(x>P){var U=new Date(r),I=U.getFullYear(),R=U.getMonth(r),D=U.getDate(),V=Math.ceil(x/P),z=v(r,n);x=V*P;for(var O=0;z+V>=O;O+=V)y.push(new Date(I,R,D+O).getTime())}else if(x>C){var U=new Date(r),I=U.getFullYear(),R=U.getMonth(r),V=U.getDate(),F=U.getHours(),E=Math.ceil(x/C),N=p(r,n);x=E*C;for(var O=0;N+E>=O;O+=E)y.push(new Date(I,R,V,F+O).getTime())}else if(x>S){var j=m(r,n),W=Math.ceil(x/S);x=W*S;for(var O=0;j+W>=O;O+=W)y.push(r+O*S)}else{r=1e3*Math.floor(r/1e3);var H=Math.ceil((n-r)/1e3),Y=Math.ceil(x/1e3);x=1e3*Y;for(var O=0;H+Y>O;O+=Y)y.push(r+1e3*O)}}}if(!y.length){r=1e3*Math.floor(r/1e3),n=1e3*Math.ceil(n/1e3);for(var i=(n-r)/x,O=0;i>=O;O++)y.push(a(x*O+r,x))}return{max:n,min:r,interval:x,ticks:y,count:y.length}},_}),define("bui/chart/numberaxis",["bui/chart/baseaxis","bui/common","bui/graphic"],function(require){function e(t){e.superclass.constructor.call(this,t)}var t=require("bui/common"),i=require("bui/chart/baseaxis"),r=require("bui/graphic").Util,n=["k","m","g","t"],a=0/0,s=r.snapFloor,o=r.snapCeiling;return t.extend(e,i),e.ATTRS={min:{},max:{},tickInterval:{},type:{value:"number"},formatter:{value:function(e){if(null==e||isNaN(e))return"";if(1e3>e)return e;var t=this.get("tickInterval");
if(t%1e3!==0)return e;for(var i=1e3,r=1;r<=n.length;r++){if(e>=i&&1e3*i>e)return e/i+n[r-1];i=1e3*i}return e/1e12+"t"}}},t.augment(e,{beforeRenderUI:function(){var t=this;if(e.superclass.beforeRenderUI.call(t),!t.get("ticks")){var i=t._getTicks(t.get("max"),t.get("min"),t.get("tickInterval"));t.set("ticks",i)}},_getTicks:function(e,t,i){var r,n=[],a=(e-t)/i;n.push(t);for(var s=1;a>=s;s++)r=i*s+t,n.push(r);return n},changeInfo:function(e){var t=this;if(e.interval&&(e.tickInterval=e.interval),e.ticks)t.set("ticks",e.ticks);else{var i=t._getTicks(e.max,e.min,e.tickInterval);t.set("ticks",i)}e.tickInterval&&t.set("tickInterval",e.tickInterval)},getOffset:function(e){e=parseFloat(e);var t=this,i=t.getRelativeOffset(e);return t._appendEndOffset(i)+t._getStartCoord()},getValue:function(e){var i,r,n,a,c,u,l=this,g=l._getStartCoord(),h=l._getEndCoord();return g>e||e>h?0/0:(i=l.get("pointCache"),r=s(i,e),n=t.Array.indexOf(r,i),u=l.get("ticks"),c=l.get("tickInterval"),avg=l._getAvgLength(u.length),r==e?u[n]:c?u[n]+(e-r)/avg*c:(a=o(i,e),u[n]+(e-r)/avg*(u[n+1]-u[n])))},_getAvgLength:function(e){var t=this,i=t._getLength();return i/(e-1)},getRelativeOffset:function(e){var i,r,n,c=this,u=c.get("ticks"),l=t.Array.indexOf(e,u),g=c.get("tickInterval"),h=c._getAvgLength(u.length);return-1!==l?h*l:(i=s(u,e),isNaN(i)?a:(l=t.Array.indexOf(i,u),n=h*l,g?n+=(e-i)/g*h:(r=o(u,e),n+=(e-i)/(r-i)*h),n))}}),e}),define("bui/chart/grid",["bui/common","bui/chart/plotitem"],function(require){function e(e,t,i){var r=t.get(e);return r||(r=i,t.set(e,r)),r}function t(e,t){var i="",n=r.mix({},t);return r.each(e,function(e){var t=r.substitute("M{x1} {y1}L{x2} {y2}",e);i+=t}),n.path=i,n}function i(e){i.superclass.constructor.call(this,e)}var r=require("bui/common"),n=require("bui/chart/plotitem"),a=require("bui/graphic").Util,s="x-chart-grid";return r.extend(i,n),i.ATTRS={zIndex:{value:1},elCls:{value:s},type:{value:"line"},line:{},minorLine:{},minorCount:{value:0},renderer:{},items:{},odd:{},even:{},animate:{value:!0},duration:{value:1e3}},r.augment(i,{renderUI:function(){var e=this;i.superclass.renderUI.call(e),e._drawLines()},_drawLines:function(){var e=this,t=e.get("line"),i=e.get("items");if(i){e._precessItems(i),e._drawGridLines(i,t,s+"-line"),e.get("minorCount")&&e.drawMinorLines()}},_precessItems:function(e){var t,i=this,n=i.get("minorCount"),a=i.get("renderer");r.each(e,function(e,r){a?a.call(this,e,r):n&&t&&i._addMonorItem(e,t),t&&(i.get("odd")||i.get("even"))&&i._drawOddEven(e,t,r),t=e})},change:function(e){var t=this;t.set("items",e),t._clearPre(),t._precessItems(e),t._changeGridLines(e,s+"-line",!0),t._changeMinorLinses()},_clearPre:function(){var e,t=this;t.get("minorCount")&&t.set("minorItems",[]),e=t.findBy(function(e){var t=e.get("elCls");return t==s+"-line"||t==s+"-minor"?!1:!0}),r.each(e,function(e){e.remove()})},_isVertical:function(e){return e.x1==e.x2?!0:!1},_drawGridLines:function(e,t,i){var r=this,n=r._linesToPath(e,t),a=r.addShape({type:"path",elCls:i,attrs:n});r.set("gridLine"+i,a)},_changeGridLines:function(e,t,i){var r=this,n=r.get("gridLine"+t);if(n){var o=r._linesToPath(e,{});i?a.animPath(n,o.path,2):n.attr("path",o.path)}else if(e&&e.length){var c;c=r.get(t==s+"-line"?"line":"minorLine"),r._drawGridLines(e,c,t)}},_linesToPath:function(e,i){var n,a=this,s=[],o=a.get("type");return"line"==o?0==e.length?"":t(e,i):(n=r.mix({},i),r.each(e,function(e){s=s.concat(a._getMultiplePath(e,o))}),n.path=s,n)},_getMultiplePath:function(e,t){var i=e.points,n=[];if("polygon"==t)r.each(i,function(e,t){n.push(0==t?["M",e.x,e.y]:["L",e.x,e.y])}),n.push(["L",i[0].x,i[0].y]),n.push(["z"]);else{var a=e.center.x,s=e.center.y,o=e.r,c=e.r;n=0==o?[]:[["M",a,s],["m",0,-c],["a",o,c,0,1,1,0,2*c],["a",o,c,0,1,1,0,-2*c]]}return n},_drawOddEven:function(e,t,i){var r,n,a=this,o=a.get("odd"),c=a.get("even");i%2==0?c&&(n=a._getBackItem(t,e,c),r="even"):o&&(n=a._getBackItem(t,e,o),r="odd"),n&&a.addShape({type:"path",elCls:s+"-"+r,attrs:n})},_getBackItem:function(e,t,i){var n=r.substitute("M {x1} {y1} L{x2} {y2}",e);return n+=r.substitute("L{x2} {y2} L{x1} {y1}Z",t),i=r.merge(i,{path:n})},_getMinorItem:function(e,t,i,r){var n=this,a=n._isVertical(e,t),s=a?"x":"y",o=a?"y":"x",c=t[s+"1"]-e[s+"1"],u=c/(r+1),l={};return l[s+"1"]=l[s+"2"]=(i+1)*u+e[s+"1"],l[o+"1"]=e[o+"1"],l[o+"2"]=e[o+"2"],l},_addMonorItem:function(t,i){var r=this,n=e("minorItems",r,[]),a=r.get("minorCount");if(a)for(var s=0;a>s;s++){var o=r._getMinorItem(i,t,s,a);n.push(o)}},drawMinorLines:function(){var e=this,t=e.get("minorLine"),i=e.get("minorItems");e._drawGridLines(i,t,s+"-minor")},_changeMinorLinses:function(){var e=this,t=e.get("minorItems");e._changeGridLines(t,s+"-minor")}}),i}),define("bui/chart/circleaxis",["bui/common","bui/graphic","bui/chart/abstractaxis"],function(require){function e(e,t,i){var r=e.getCenter(),a={};return a.x=r.x+t*Math.sin(i*n),a.y=r.y-t*Math.cos(i*n),a}var t=require("bui/common"),i=require("bui/graphic").Util,r=require("bui/chart/abstractaxis"),n=Math.PI/180,a=function(e){a.superclass.constructor.call(this,e)};return t.extend(a,r),a.ATTRS={type:{value:"circle"},startAngle:{value:0},endAngle:{value:360},margin:{value:20},radius:{},tickInterval:{},grid:{shared:!1,value:{line:{"stroke-width":1,stroke:"#C0D0E0"}}},formatter:{value:function(e){var i=this,r=i.get("ticks");if(t.isNumber(e)){var n=t.Array.indexOf(e,r);if(-1==n){var a=i.getTickAvgAngle();n=parseInt(e/a,10),e=r[n]}}return e}}},t.augment(a,{beforeRenderUI:function(){var e=this;a.superclass.beforeRenderUI.call(e);var t,i=e.get("tickInterval"),r=e.get("ticks"),n=e.get("startAngle"),s=e.get("endAngle");if(i&&!r){r=[],t=(s-n)/i;for(var o=0;t>o;o++)r.push(n+i*o);e.set("ticks",r)}},getCenter:function(){var e=this,t=e.get("plotRange");return t.cc},getRadius:function(){var e=this,t=e.get("radius"),i=e.get("plotRange");return t||(t=Math.min(i.getWidth(),i.getHeight())/2-e.get("margin"),e.set("radius",t)),t},getTickAvgAngle:function(){var e=this,t=e.get("ticks"),i=e.get("startAngle"),r=e.get("endAngle");return(r-i)/t.length},getLinePath:function(){var e=this,t=e.getCenter(),i=t.x,r=t.y,n=e.getRadius(),a=n;return[["M",i,r],["m",0,-a],["a",n,a,0,1,1,0,2*a],["a",n,a,0,1,1,0,-2*a],["z"]]},getOffsetPoint:function(e){var t=this,i=t.getOffsetByIndex(e),r=t.getRadius();return t.getCirclePoint(i,r)},getCirclePoint:function(t,i){return null==i&&(i=this.getRadius()),e(this,i,t)},getDistance:function(e,t){var i=this,r=i.getCenter();return Math.sqrt(Math.pow(e-r.x,2)+Math.pow(t-r.y,2))},getCircleAngle:function(e,t){var i=this,r=i.getCenter(),n=i.getDistance(e,t),a=Math.asin(Math.abs(e-r.x)/n)/Math.PI*180;return e>=r.x&&t<=r.y?a:e>=r.x&&t>=r.y?180-a:e<=r.x&&t>=r.y?a+180:360-a},getOffsetByIndex:function(e){var t=this,i=t.get("ticks"),r=i.length,n=t.get("startAngle"),a=t.get("endAngle");return n+(a-n)/r*e},getValue:function(e){return this.getSnapValue(e)},getSnapValue:function(e){var t=this,r=t.get("pointCache");return i.snapFloor(r,e)},getGridItemCfg:function(e){var t=this,i=t.getCenter();return{x1:i.x,y1:i.y,x2:e.x,y2:e.y}},addLabel:function(e,t,i){var r=this,n=r.get("margin"),s=r.getRadius();t=r.getCirclePoint(i,s+n),a.superclass.addLabel.call(r,e,t)},getTickEnd:function(e,t){var i=this,r=i.getRadius(),n=i.get("tickLine"),a=n.value,s=i.getCirclePoint(t,r+a);return{x2:s.x,y2:s.y}}}),a}),define("bui/chart/radiusaxis",["bui/common","bui/chart/numberaxis"],function(require){var e=require("bui/common"),t=require("bui/chart/numberaxis"),i=function(e){i.superclass.constructor.call(this,e)};return i.ATTRS={circle:{},position:{value:"left"},type:{value:"radius"}},e.extend(i,t),e.augment(i,{beforeRenderUI:function(){i.superclass.beforeRenderUI.call(this);var e=this,t=e.get("circle");e.set("start",t.getCenter()),e.set("end",t.getCirclePoint(0))},getGridItemCfg:function(e){for(var t=this,i={},r=[],n=t.get("circle"),a=n.getCenter(),s=n.getTicksCount(),o=Math.abs(e.y-a.y),c=0;s>c;c++){var u=n.getOffsetByIndex(c),l=n.getCirclePoint(u,o);r.push(l)}return i.points=r,i.r=o,i.center=a,i},getPointByAngle:function(e,t){var i=this,r=i.get("circle"),n=r.getCenter(),a=i.getOffset(t);return r.getCirclePoint(e,Math.abs(a-n.y))}}),i}),define("bui/chart/timeaxis",["bui/common","bui/chart/numberaxis"],function(require){function e(e){if(e instanceof Date)return e.getTime();if(t.isNumber(e))return e;var i=e;return t.isString(e)&&(i=e.replace("-","/"),i=new Date(i).getTime()),i}var t=require("bui/common"),i=require("bui/chart/numberaxis"),r=function(e){r.superclass.constructor.call(this,e)};return r.ATTRS={startDate:{},dateFormat:{},endDate:{}},t.extend(r,i),t.augment(r,{beforeRenderUI:function(){var t=this,i=e(t.get("startDate")),n=e(t.get("endDate"));i&&!t.get("min")&&t.set("min",i),n&&!t.get("max")&&t.set("max",n),r.superclass.beforeRenderUI.call(t)}}),r}),define("bui/chart/categoryaxis",["bui/chart/baseaxis","bui/common"],function(require){function e(t){e.superclass.constructor.call(this,t)}var t=require("bui/common"),i=require("bui/chart/baseaxis");return t.extend(e,i),e.ATTRS={categories:{},type:{value:"category"}},t.augment(e,{beforeRenderUI:function(){var t=this;if(e.superclass.beforeRenderUI.call(t),!t.get("ticks")){var i=t.get("categories"),r=[];r=r.concat(i),r.push(" "),t.set("ticks",r)}},changeInfo:function(e){var t=this,i=[];i=i.concat(e.categories),i.length&&i.push(" "),t.set("categories",e.categories),t.set("ticks",i)},getOffsetByIndex:function(e){var t=this,i=t._getAvgLength(),r=i*e;return r>=0?r+=i/2:r-=i/2,t._appendEndOffset(r)+t._getStartCoord()},getValue:function(e){var t=this,i=t.getSnapIndex(e),r=t.get("categories");return r[i]},changeAxis:function(){},_getAvgLength:function(){var e=this,t=e._getLength(),i=e.get("ticks"),r=i.length,n=t/(r-1);return n},getTickOffsetPoint:function(e){var t=this,i=t._getOrthoCoord(),r=t._getAvgLength(),n=t.getOffsetByIndex(e);return n>=0?n-=r/2:n+=r/2,t.isVertical()?{x:i,y:n}:{x:n,y:i}}}),e}),define("bui/chart/axis",["bui/common","bui/chart/baseaxis","bui/chart/categoryaxis","bui/chart/numberaxis","bui/chart/timeaxis","bui/chart/circleaxis","bui/chart/radiusaxis"],function(require){var e=(require("bui/common"),require("bui/chart/baseaxis"));return e.Category=require("bui/chart/categoryaxis"),e.Number=require("bui/chart/numberaxis"),e.Time=require("bui/chart/timeaxis"),e.Auto=require("bui/chart/axis/auto"),e.Circle=require("bui/chart/circleaxis"),e.Radius=require("bui/chart/radiusaxis"),e}),define("bui/chart/baseseries",["bui/chart/plotitem","bui/chart/showlabels","bui/chart/markers","bui/chart/actived"],function(require){var e=require("bui/common"),t=require("bui/chart/plotitem"),i=require("bui/chart/showlabels"),r=require("bui/chart/actived"),n=require("bui/chart/markers"),a=function(e){a.superclass.constructor.call(this,e)};return e.extend(a,t),e.mixin(a,[i,r]),a.ATTRS={zIndex:{value:5},markers:{},labels:{},animate:{value:!1},duration:{value:1e3},changeDuration:{value:400},inLegend:{value:!0},data:{value:[],shared:!1},autoPaint:{value:!0},enableMouseTracking:{value:!0},stickyTracking:{value:!0},xField:{value:"x"},yField:{value:"y"},itemName:{value:"seriesItem"},groupName:{value:"series"}},e.augment(a,{renderUI:function(){var e=this;a.superclass.renderUI.call(e),e.processColor(),e.renderLabels(),e.renderMarkers(),e.get("autoPaint")&&e.paint()},bindUI:function(){var e=this;if(a.superclass.bindUI.call(e),e.get("enableMouseTracking")){e.onMouseOver();var t=e.get("parent");e.on("mouseover",function(){t.setActivedItem&&(t.isItemActived(e)||t.setActivedItem(e))})}e.get("stickyTracking")||e.onMouseOut()},changeData:function(e,t){var i=this,r=i.get("data"),n=i.get("parent");e!=r&&i.set("data",e),t&&(n?n.repaint():i.get("visible")&&i.repaint())},addPoint:function(e,t,i){var r=this,n=r.get("data");n.push(e),t&&(n.shift(),i&&n.unshift(n[0])),r.changeData(n,i),t&&setTimeout(function(){n.shift(),r.set("points",null),i&&(r.shiftPoint(),r.changeShapes(r.getPoints(),!1))},800)},shiftPoint:function(){var e,t=this,i=t.get("markersGroup"),r=t.get("labelsGroup"),n=t.get("xAxis");if(i&&(e=i.getChildAt(0),e&&e.remove()),r&&(e=r.getChildAt(0),e&&e.remove()),n){var a=n.get("labelsGroup");a&&(e=a.getChildAt(0),e&&e.remove())}},getData:function(){},onMouseOver:function(){},onMouseOut:function(){},onStickyTracking:function(){},processColor:function(){},getTrackingInfo:function(){},getPoints:function(){var e=this,t=e.get("points");return t||(t=e._getPoints(),e.set("points",t)),t},_getPoints:function(){var t=this,i=t.get("data"),r=t.get("xField"),n=t.get("yField"),a=[];return e.each(i,function(i,s){var o;if(e.isObject(i)){var c=i[r],u=i[n];o=null==c?t.getPointByIndex(u,s):t.getPointByValue(c,u),o.obj=i}else e.isArray(i)?(o=t.getPointByValue(i[0],i[1]),o.arr=i):o=t.getPointByIndex(i,s);t.processPoint(o,s),a.push(o)}),a},processPoint:function(){},getPointByObject:function(){},getPointByIndex:function(){},getPointByValue:function(){},getTipItem:function(e){return e.value},findPointByValue:function(t){var i,r=this,n=r.get("points");return e.each(n,function(e){return r.snapEqual(e.xValue,t)&&null!=e.value?(i=e,!1):void 0}),i},snapEqual:function(e,t){return e==t},draw:function(){},paint:function(){var e=this,t=e.getPoints();!e.get("isPaint")&&e.get("data").length&&(e.set("painting",!0),e.draw(t,function(){e.sort()}),e.set("isPaint",!0),e.set("painting",!1))},repaint:function(){var t,i=this,r=i.get("labels"),n=i.get("markers");return i.set("points",null),i.get("isPaint")||i.get("painting")?(t=i.getPoints(),r&&(r.items=[]),n&&(n.items=[]),i.changeShapes(t),e.each(t,function(e){if(r){var t={};t.text=e.value,t.x=e.x,t.y=e.y,r.items.push(t)}n&&n.items.push(e)}),i._changeMarkers(),void i._changeLabels()):void i.paint()},changeShapes:function(){},addMarker:function(t){var i,r=this,n=r.get("markersGroup"),a={};return n&&(a.x=t.x,a.y=t.y,t.obj&&t.obj.marker&&e.mix(a,t.obj.marker),i=n.addMarker(a),i.set("point",t)),i},renderMarkers:function(){var e,t=this,i=t.get("markers");i&&(i||(i.items=[]),e=t.addGroup(n,i),t.set("markersGroup",e))},_changeMarkers:function(){var e,t=this,i=t.get("markers");i&&(e=t.get("markersGroup"),e.change(i.items))},_changeLabels:function(){this.resetLabels()},removeMarkers:function(){var e=this,t=e.get("markersGroup");t&&t.remove()},getActiveAtrrs:function(){},getUnActiveAttrs:function(){},setActiveStatus:function(){},remove:function(){var e=this;e.removeMarkers(),e.removeLabels(),a.superclass.remove.call(this)}}),a}),define("bui/chart/series/stacked",function(require){var e=require("bui/common"),t=function(){};return t.ATTRS={stackType:{value:"none"}},e.augment(t,{processStackedPoint:function(e,t){var i=this,r=i.getVisiblePrev();if(r){var n=r.getPoints()[t],a=i.getBaseValue();if(i.isInCircle()){var s,o=i.get("xAxis"),c=o.getDistance(e.x,e.y),u=n.r||o.getDistance(n.x,n.y);c=u+c,s=o.getCirclePoint(e.xValue,c),e.x=s.x,e.y=s.y,e.r=c,e.ir=u}else e.y=e.y+n.y-a;e.lowY=n.y,e.lowX=n.x}},getStackedPercent:function(e,t){var i=this,r=i.get("parent").getStackedData(i.get("yAxis"),"yAxis"),n=r[t];return n?e/n:0/0},parseYValue:function(t){var i,r=this,n=r.get("stackType"),a=r.get("data"),s=e.Array.indexOf(t,a);return"percent"==n&&(i=r.getStackedPercent(t,s),t=100*i),t},getVisiblePrev:function(){var t,i=this,r=i.get("parent"),n=i.get("yAxis"),a=r.get("children");return e.each(a,function(e){return e==i?!1:void(e.get("visible")&&e.get("yAxis")==n&&(t=e))}),t},getTipItem:function(e){var t=this,i=t.get("stackType");if("percent"==i){var r=e.yValue||0;return[e.value,"\uff08"+r.toFixed(2)+"%\uff09"]}return e.value},isStacked:function(){var e=this,t=e.get("stackType");return t&&"none"!==t}}),t}),define("bui/chart/series/itemgroup",["bui/chart/baseseries"],function(require){var e=require("bui/common"),t=require("bui/chart/baseseries"),i=require("bui/graphic").Util,r=function(){};return r.ATTRS={item:{},group:{},allowPointSelect:{value:!1},cancelSelect:{value:!0}},e.extend(r,t),e.augment(r,{addItem:function(e,t){var i,r=this,n=r.get("group");if(null!=e.value){null==t&&(t=r.getItems().length),n||(n=r.addGroup(),r.set("group",n)),i=r.getItemCfg(e,t),i.path=r.get("animate")?r.pointToFactorPath(e,0):r.pointToPath(e);var a=n.addShape("path",i);return a.isSeriesItem=!0,a.set("point",e),a}},bindItemClick:function(){var e=this,t=e.get("cancelSelect");e.on("click",function(i){var r,n=i.target,a=n.shape;a&&a.isSeriesItem&&(e.get("allowPointSelect")&&(r=a.get("selected"),t&&r?e.clearSelected(a):e.setSelected(a)),e.fireUpGroup("click",a))})},setSelected:function(e){var t=this;t.isSelected(e)||(t.clearSelected(),t.setItemSelected(e,!0),t.onSelected(e))},changePoints:function(t){var i=this,r=i.getItems(),n=i.get("animate");t=t||i.getPoints(),e.each(r,function(e,r){var a,s,o=t[r];o&&(a=e.get("point"),e.set("point",o),e.set("prePoint",a),n?i.animateItem(e,a):(s=i.pointToPath(o),e.attr("path",s)))});for(var a=t.length,s=r.length,o=s;a>o;o++){var c=i.addItem(t[o],o);n&&i.animateItem(c,r[s-1].get("prePoint"))}for(var o=s-1;o>=a;o--){var u=r[o];u.remove()}},onSelected:function(e){this.fireUpGroup("selected",e)},onUnSelected:function(e){this.fireUpGroup("unselected",e)},clearSelected:function(e){var t=this;e=e||t.getSelected(),e&&(t.setItemSelected(e,!1),t.onUnSelected(e))},setItemSelected:function(){},isSelected:function(e){return e&&e.get("selected")},getSelected:function(){var t,i=this,r=i.getItems();return e.each(r,function(e){return i.isSelected(e)?(t=e,!1):void 0}),t},getItemCfg:function(t){var i=this,r=i.get("item"),n=t.obj,a={};return e.mix(a,r),n&&n.attrs&&e.mix(a,n.attrs),a},getItems:function(){var e=this.get("group");return e?e.get("children"):[]},animateItems:function(t){var r=this,n=r.getItems();i.animStep(r.get("duration"),function(t){e.each(n,function(e){var i=e.get("point"),n=r.pointToFactorPath(i,t);e.attr("path",n)})},t)},animateItem:function(e){var t=this,i=e.get("point"),r=t.pointToPath(i);e.animate({path:r},t.get("changeDuration"))},removeItem:function(e){var t=this;t.removeLabel(e),e.remove()},removeLabel:function(e){var t=e.get("label");t&&t.remove()},pointToFactorPath:function(){},pointToPath:function(e){return this.pointToFactorPath(e,1)}}),r}),define("bui/chart/cartesianseries",["bui/chart/baseseries","bui/graphic"],function(require){function e(e){return i.isNumber(e)?e:(i.isString(e)?(e=e.replace(/'-'/gi,"/"),e=new Date(e).getTime()):i.isDate(e)&&(e=e.getTime()),e)}function t(e){t.superclass.constructor.call(this,e)}var i=require("bui/common"),r=require("bui/chart/baseseries"),n=require("bui/graphic").Util;return t.ATTRS={pointInterval:{},pointStart:{value:0},xAxis:{},yAxis:{},pointsCache:{shared:!1,value:{}}},i.extend(t,r),i.augment(t,{getPoint:function(t,r){var n=this,a=n.get("xAxis"),s=n.get("yAxis"),o=n.parseYValue(r),c={};return"time"==a.get("type")&&(t=e(t)),n.isInCircle()?c=s.getPointByAngle(t,o):(c.x=a.getOffset(t),c.y=s.getOffset(o)),i.mix(c,{yValue:o,xValue:t,value:r}),c},changeData:function(e,i){this.set("pointsCache",{}),t.superclass.changeData.call(this,e,i)},getPointByObject:function(e){var t=this,i=t.get("xField"),r=t.get("yField"),n=t.getPoint(e[i],e[r]);return n.value=e[r],n.xValue=e[i],n.yValue=t.parseYValue(e[r]),n.obj=e,n},getPointByValue:function(e,t){return this.getPoint(e,t)},parseYValue:function(e){return e},snapEqual:function(e,t){var r=this;if(i.isString(e))return e==t;var n=r.get("pointInterval");return n?Math.abs(e-t)<n/2:e==t},isInCircle:function(){return"circle"==this.get("xAxis").get("type")},getCircleCenter:function(){var e=this,t=e.get("xAxis"),i=null;return"circle"==t.get("type")&&(i=t.getCenter()),i},getCircle:function(){return this.isInCircle()?this.get("xAxis"):null},getData:function(e){var t=this,r=t.get("data"),n=t.get("pointsCache"),a=t.get("xAxis"),s=(r[0],[]),o=t.get("pointStart");if(e=e||"yAxis",n[e])return n[e];if("xAxis"!=e||null==o||"time"==a.get("type")&&0==o||!t.get("pointInterval")){var c=t.get("xField"),u=t.get("yField");i.each(r,function(t){if(i.isNumber(t)||i.isString(t))s.push(t);else if(i.isArray(t)){var r="yAxis"==e?t[1]:t[0];s.push(r)}else if(t){var r="yAxis"==e?t[u]:t[c];s.push(r)}})}else{var l=t.get("pointInterval");s.push(o),s.push(o+(r.length-1)*l)}return n[e]=s,s},getPointByIndex:function(e,t){var i,r,a=this,s=a.get("xAxis"),o=a.get("yAxis"),c=a.parseYValue(e),u=o.getOffset(c);if("number"==s.get("type")||"time"==s.get("type")){var l=a.get("pointStart"),g=a.get("pointInterval");i=s.getOffset(l+g*t)}else i=s.getOffsetByIndex(t);return a.isInCircle()?a.getPoint(i,e):(r=s.getValue(i),g&&(r=n.tryFixed(r,g)),{x:i,y:u,xValue:r,yValue:c,value:e})},getTrackingInfo:function(e){var t,i=this,r=i.get("xAxis");if(i.isInCircle()){var n=r.getCircleAngle(e.x,e.y);t=r.getValue(n)}else t=r.getValue(e.x);return i.findPointByValue(t)},getBaseValue:function(){var e=this,t=e.get("yAxis"),i=t.getOffset(0)||t.getStartOffset();return i}}),t}),define("bui/chart/lineseries",["bui/chart/cartesianseries","bui/graphic"],function(require){function e(e,t,i){e&&!e[t]&&(e[t]=i)}function t(e){t.superclass.constructor.call(this,e)}var i=require("bui/common"),r=require("bui/chart/cartesianseries"),n=require("bui/graphic").Util;return i.extend(t,r),t.ATTRS={type:{value:"line"},elCls:{value:"x-chart-line-series"},connectNulls:{value:!1},line:{},lineActived:{},tolerance:{value:20},smooth:{value:!1}},i.augment(t,{processColor:function(){var t=this,i=t.get("color");if(i){var r=t.get("line"),n=t.get("markers");e(r,"stroke",i),n&&!/http/.test(n.marker.symbol)&&(e(n.marker,"stroke",i),e(n.marker,"fill",i))}},onStickyTracking:function(e){var t=this,i=e.point,r=t.get("markersGroup"),n=t.getSnapMarker(i);r&&r.setActivedItem(n)},changeShapes:function(e,t){e=e||this.getPoints();var i=this,r=i.get("lineShape"),a=i.points2path(e);if(null==t&&(t=i.get("animate")),r)if(t){if(n.svg&&i.get("smooth")){var s=r.getPath();r.attr("path",a),a=r.attr("path"),r.attr("path",s)}n.animPath(r,a)}else r.attr("path",a)},draw:function(e,t){function r(){s.drawTracker(e),t&&t()}var a,s=this,o=s.get("animate"),c=s.get("duration"),u="";if(o)if(a=s._createLine(u),s.isInCircle())s.circleAnimate(e,a);else{var l=0,g=[],h=e.length;n.animStep(c,function(t){var i=l;if(l=parseInt(t*h,10),l>h-1&&(l=h-1),l!=i){g=e.slice(0,l+1),u=s.points2path(g),a.attr("path",u),s.drawInner(g);for(var r=i;l>r;r++)s._drawPoint(e[r])}1==t&&s._drawPoint(e[l])},r)}else u=s.points2path(e),a=s._createLine(u),i.each(e,function(e){s._drawPoint(e)}),s.drawInner(e),r()},circleAnimate:function(e,t){var r,n=this,a=n.getCircle(),s=a.getCenter(),o=[],c=n.getBaseValue();i.each(e,function(){var e=i.mix({value:c},s);o.push(e),n._drawPoint(e)}),r=n.points2path(o),t.attr("path",r),n.drawInner(o),n.repaint()},drawInner:function(){},_drawPoint:function(e){var t=this;t.get("markers")&&!t.get("markersGroup").get("single")&&t.addMarker(e),t.get("labels")&&t.addLabel(e.value,e)},_createLine:function(e){var t=this,r=t.get("line"),n=i.mix({},r);return n.path=e,lineShape=t.addShape("path",n),t.set("lineShape",lineShape),lineShape},drawTracker:function(e){var t,r=this,n=r.get("line"),a=r.get("tolerance"),s=r.points2tracker(e),o=i.mix({},n),c=Number(n["stroke-width"]);o["stroke-width"]=c+a,o["stroke-opacity"]=.001,o.path=s,t=r.addShape("path",o),r.set("trackerShape",t)},points2path:function(e){if(!e.length)return"";var t,r,n=this,a=n.get("smooth"),s=n.get("connectNulls"),o="";return e.length<=2&&(a=!1),i.each(e,function(e){if(null==e.value){if(s)return;r=""}else r=null==t||null==t.value?a?"M{x} {y} R":"M{x} {y}":a?" {x} {y}":"L{x} {y}";o+=i.substitute(r,e),t=e}),n.isInCircle()&&(o+="z"),o},points2tracker:function(e){if(!e.length)return"";var t=this,r=t.get("tolerance"),n=(e[0],"M"+(e[0].x-r)+" "+(e[0].y||0));return i.each(e,function(e){if(null!=e.value){var t="L{x} {y}";n+=i.substitute(t,e)}}),t.isInCircle()&&(n+="z"),n},setActiveStatus:function(e){var t=this,i=t.get("line"),r=t.get("lineShape"),n=t.get("lineActived");if(e)n&&r.attr(n);else{i&&r.attr(i);var a=t.get("markersGroup");a&&a.clearActivedItem()}},getSnapMarker:function(e){var t=this,i=t.get("markersGroup"),r=null;if(i)if(t.isInCircle()){var n=t.getTrackingInfo(e);r=i.getSnapMarker(n)}else r=i.getSnapMarker(e.x);return r}}),t}),define("bui/chart/areaseries",["bui/common","bui/chart/lineseries","bui/graphic","bui/chart/series/stacked"],function(require){function e(e,t,i){e&&!e[t]&&(e[t]=i)}var t=require("bui/common"),i=require("bui/chart/lineseries"),r=require("bui/graphic").Util,n=require("bui/chart/series/stacked"),a=/^M.*(M).*$/,s=function(e){s.superclass.constructor.call(this,e)};return s.ATTRS={area:{shared:!1,value:{stroke:"","fill-opacity":"0.70"}}},t.extend(s,i),t.mixin(s,[n]),t.augment(s,{processColor:function(){s.superclass.processColor.call(this);var t=this,i=t.get("color"),r=t.get("area");e(r,"fill",i)},renderUI:function(){s.superclass.renderUI.call(this);var e=this,t=e.get("canvas"),i=e.get("markersGroup");i&&e.isStacked()&&$(i.get("node")).appendTo(t.get("node"))},hide:function(){s.superclass.hide.call(this);var e=this,t=e.get("markersGroup");t&&t.hide()},show:function(){s.superclass.show.call(this);var e=this,t=e.get("markersGroup");t&&t.show()},drawInner:function(e){var t=this,i=t.get("areaShape");if(i){var r=t._getAreaPath(e);i.attr("path",r)}else t.drawArea(e)},_getAreaPath:function(e){var t,i=this,r=i.get("stackType");return t=r&&"none"!=r?i.points2StackArea(e):i.points2area(e)},changeShapes:function(){s.superclass.changeShapes.call(this);var e=this,t=e.get("areaShape"),i=e.getPoints(),n=e._getAreaPath(i);r.animPath(t,n)},drawArea:function(e){var i,r=this,n=r.get("area"),a=r.isStacked()?r.points2StackArea(e):r.points2area(e),s=t.mix({path:a},n);i=r.addShape("path",s),r.set("areaShape",i)},processPoint:function(e,t){var i=this,r=i.get("stackType");r&&"none"!=r&&i.processStackedPoint(e,t)},points2StackArea:function(e){var t,i,r=this,n=e.length,a=r.getBaseValue(),s=e[0],o=e[n-1],c=r.isInCircle(),u="";if(n){if(i=r.getVisiblePrev(),t=r.points2path(e),u=t,i){var l=i.getPoints().slice(0,e.length),g=l[0],h=r.points2path(l.reverse());h=h.replace("M","L"),u=c?t+"L"+g.x+" "+g.y+h:t+h}else c||(u="M "+s.x+" "+a+t.replace("M","L"),u=u+"L "+o.x+" "+a);u&&!c&&(u+="z")}return u},points2area:function(e){var i,n=this,s=e.length,o=n.getBaseValue(),c=e[0],u=e[s-1],l=n.isInCircle(),g="";if(s)if(i=n.points2path(e),l){{n.getCircleCenter()}g=i}else if(g="M "+c.x+" "+o,g+=i.replace("M","L"),a.test(g)){g=r.parsePathString(g);var h=[],f=c;t.each(g,function(e,t){if(0!==t&&"M"==e[0]){var i=[],r=[],n=[],a=g[t-1];i[0]="L",i[1]=a[1],i[2]=o,r[0]="L",r[1]=f.x,r[2]=o,n[0]="M",n[1]=e[1],n[2]=o,"R"==a[0]?(a[0]="L",e[0]="R"):e[0]="L",h.push(i),h.push(r),h.push(n),f=e}h.push(e)}),g=h,g.push(["L",u.x,o]),r.svg&&g.push(["Z"])}else g=g+"L "+u.x+" "+o+"z";return g}}),s}),define("bui/chart/scatterseries",["bui/chart/cartesianseries","bui/chart/activedgroup"],function(require){function e(e,t,i){e&&!e[t]&&(e[t]=i)}var t=require("bui/common"),i=require("bui/chart/cartesianseries"),r=(require("bui/chart/activedgroup"),function(e){r.superclass.constructor.call(this,e)});return r.ATTRS={elCls:{value:"x-chart-scatter"},stickyTracking:{value:!1},animate:{value:!1}},t.extend(r,i),t.augment(r,{processColor:function(){var t=this,i=t.get("color");if(i){var r=t.get("markers");r&&(e(r.marker,"stroke",i),e(r.marker,"fill",i))}},draw:function(e){var i=this;t.each(e,function(e){i.addMarker(e)})},onMouseOver:function(){var e=this,t=e.get("markersGroup");t&&t.on("mouseover",function(e){var i=e.target,r=i.shape;r&&t.setActivedItem(r)})},getTrackingInfo:function(){var e,t,i=this,r=i.get("markersGroup");return r&&(e=r.getActived(),e&&(t=e.get("point"))),t},onMouseOut:function(){var e=this,t=e.get("markersGroup");t&&t.on("mouseout",function(e){var i=e.target,r=i.shape;r&&t.clearActivedItem(r)})}}),r}),define("bui/chart/bubbleseries",["bui/common","bui/chart/cartesianseries","bui/graphic","bui/chart/activedgroup"],function(require){var e=require("bui/common"),t=require("bui/chart/cartesianseries"),i=require("bui/chart/activedgroup"),r=require("bui/graphic").Util,n=function(e){n.superclass.constructor.call(this,e)};return n.ATTRS={elCls:{value:"x-chart-bubble"},type:{value:"buble"},circle:{shared:!1,value:{}},activeCircle:{value:{}},animate:{value:!0},stickyTracking:{value:!1}},e.extend(n,t),e.mixin(n,[i]),e.augment(n,{processColor:function(){var e=this,t=e.get("color");if(t){var i=e.get("circle");i&&(r.trySet(i,"stroke",t),r.trySet(i,"fill",t))}},renderUI:function(){n.superclass.renderUI.call(this),this._renderGroup()},draw:function(t){var i=this;e.each(t,function(e){i.addBubble(e)})},changeShapes:function(){var t=this,i=t.getPoints(),r=t.getItems();e.each(r,function(e,r){var n=i[r];e.animate({cx:n.x,cy:n.y},t.get("changeDuration")),e.set("point",n)})},getItems:function(){return this.get("group").get("children")},getActiveItems:function(){return this.getItems()},_renderGroup:function(){var e=this,t=e.addGroup();e.set("group",t)},setItemActived:function(e,t){var i=this,r=i.get("circle"),n=i.get("activeCircle");t?(e.attr(n),e.set("actived",!0)):(e.attr(r),e.set("actived",!1))},getTrackingInfo:function(){var e=this,t=e.getActived();return t&&t.get("point")},isItemActived:function(e){return e.get("actived")},addBubble:function(t){var i,n,a=this,s=a.get("circle"),o=5,c=e.mix({},s);t.obj&&(o=t.obj.r),t.arr&&(o=t.arr[2]),i=a._getRadius(o),c.cx=t.x,c.cy=t.y,a.get("animate")&&r.svg?(c.r=0,n=a.get("group").addShape("circle",c),n.animate({r:i},a.get("duration"))):(c.r=i,n=a.get("group").addShape("circle",c)),n.set("point",t)},_getRadius:function(e){return Math.pow(e,.75)},onMouseOver:function(){var e=this;e.get("group").on("mouseover",function(t){var i=t.target,r=i.shape;e.setItemActived(r,!0)})},onMouseOut:function(){var e=this;e.get("group").on("mouseout",function(t){var i=t.target,r=i.shape;e.setItemActived(r,!1)})}}),n}),define("bui/chart/columnseries",["bui/common","bui/graphic","bui/chart/activedgroup","bui/chart/series/stacked"],function(require){function e(e,t){var i=Raphael.color(e),r=i.l*(1+t);return Raphael.hsl2rgb(i.h,i.s,r).hex}function t(e,t,i,r,n){var a,s=n.getCenter(),o=s.x,c=s.y,u=n.getCirclePoint(e,i),l=n.getCirclePoint(t,i);if(r){var g=n.getCirclePoint(e,r),h=n.getCirclePoint(t,r);a=[],a.push(["M",g.x,g.y]),a.push(["L",u.x,u.y]),a.push(["A",i,i,0,+(t-e>180),1,l.x,l.y]),a.push(["L",h.x,h.y]),a.push(["A",r,r,0,+(t-e>180),0,g.x,g.y]),a.push(["z"])}else a=["M",o,c,"L",u.x,u.y,"A",i,i,0,+(t-e>180),1,l.x,l.y,"z"];return a}var i=require("bui/common"),r=require("bui/graphic").Util,n=require("bui/chart/cartesianseries"),a=require("bui/chart/activedgroup"),s=require("bui/chart/series/stacked"),o=require("bui/chart/series/itemgroup"),c=function(e){c.superclass.constructor.call(this,e)};return c.ATTRS={type:{value:"column"},elCls:{value:"x-chart-column"},columnWidth:{},columnOffset:{value:0},cancelSelect:{value:!1},stackPadding:{value:1},animate:{value:!0},duration:{value:1e3},item:{shared:!1,value:{stroke:"none","stroke-width":1,"fill-opacity":.75}}},i.extend(c,n),i.mixin(c,[o,a,s]),i.augment(c,{processColor:function(){var e=this,t=e.get("color");if(t){var i=e.get("item");i.fill||(i.fill=t)}},bindUI:function(){c.superclass.bindUI.call(this),this.bindItemClick()},draw:function(e){var t=this;t.resetWidth(),i.each(e,function(e,i){t._drawPoint(e,i)}),t.get("animate")&&t.animateItems(),t.sort()},_drawPoint:function(e,t){var i=this,r=i.addItem(e,t);if(i.get("labels")){var n=i.addLabel(e.value,e);r.set("label",n)}},addPoint:function(e,t,i){var r=this,n=r.get("data");n.push(e),t&&(n.shift(),i&&r.shiftPoint()),r.changeData(n,i)},shiftPoint:function(){var e=this,t=e.getItems()[0];t&&t.remove(),c.superclass.shiftPoint.call(this)},resetWidth:function(){if(this.isInCircle())return void this.resetCircleWidth();var e,t,i,r,n=this,a=n.get("xAxis"),s=a.getTickAvgLength(),o=10,c=n._getIndexInfo();t=c.count,e=c.curIndex,i=s/2/t,o=.5*i,r=.5*(s-t*i-(t-1)*o)+((e+1)*i+e*o)-.5*i-.5*s,n.set("columnWidth",i),n.set("columnOffset",r)},_getIndexInfo:function(){var e,t,r=this,n=r.get("parent"),a=n.getSeries(),s=[];return r.isStacked()?(t=1,e=0):(i.each(a,function(e){e.get("visible")&&"column"==e.get("type")&&s.push(e)
}),t=s.length,e=i.Array.indexOf(r,s)),{curIndex:e,count:t}},resetCircleWidth:function(){var e,t,i,r,n=this,a=n.get("xAxis"),s=a.getTickAvgAngle();info=n._getIndexInfo(),t=info.count,e=info.curIndex,i=s/t,r=e*i,n.set("columnWidth",i),n.set("columnOffset",r)},changeShapes:function(e){var t=this;t.resetWidth(),t.changePoints(e)},getActiveItems:function(){return this.getItems()},isItemActived:function(e){return e.get("actived")},setItemActived:function(t,i){var r=t.getCfgAttr("attrs").fill;i?(t.attr("fill",e(r,.2)),t.set("actived",!0)):(t.attr("fill",r),t.set("actived",!1))},setItemSelected:function(e,t){var i=e.getCfgAttr("attrs"),n=i.fill,a=i.stroke,s=i["stroke-width"];t?(e.attr({stroke:r.dark(n,.3),"stroke-width":2}),e.set("selected",!0)):(e.attr({stroke:a,"stroke-width":s}),e.set("selected",!1))},onStickyTracking:function(e){var t=this,r=t.getTrackingInfo(e.point),n=t.getItems();r&&i.each(n,function(e){e.get("point").x==r.x&&e.get("point").y==r.y&&t.setActivedItem(e)})},pointToFactorPath:function(e,i){var r,n,a=this,s=(a.get("item"),a.get("columnWidth")),o=a.get("columnOffset"),c=0,u=a.getBaseValue(),l=a.isInCircle(),g=[];if(l){var h=a.get("xAxis"),f=e.xValue,d=o+f,v=o+f+s,p=e.r||h.getDistance(e.x,e.y),m=e.ir||0;p*=i,m*=i,g=t(d,v,p,m,h)}else a.isStacked()&&e.lowY?(n=e.lowY,c=a.get("stackPadding")):n=u,n-=c,r=e.y-n,g.push(["M",e.x+o-s/2,u+(n-u)*i]),g.push(["v",r*i]),g.push(["h",s]),g.push(["v",-1*r*i]),g.push(["z"]);return g},processPoint:function(e,t){var i=this,r=i.get("stackType");r&&"none"!=r&&i.processStackedPoint(e,t)}}),c}),define("bui/chart/pieseries",["bui/common","bui/graphic","bui/chart/baseseries","bui/chart/series/itemgroup"],function(require){function e(e,t){if(s.isNumber(t))return t;var n=r(e),a=i(t),o=n.getWidth();return n.tl.x+o*a}function t(e,t){if(s.isNumber(t))return t;var n=r(e),a=i(t),o=n.getHeight();return n.tl.y+o*a}function i(e){return.01*parseFloat(e)}function r(e){return e.get("parent").get("plotRange")}function n(e,t,i,r,n){var a=i-Math.acos((r-t)/r)/Math.PI*180;e.orignAngle=e.angle,e.angle=a,e.orignX=e.x,e.orignY=e.y,e.x=n.x+(r+5)*Math.cos(e.angle*g),e.y=n.y+(r+5)*Math.sin(e.angle*g)}function a(e,t,i,r,a){var s=parseInt(2*t/f,10),o=e.y+t,c=e.y-t;s<i.length&&i.splice(s,i.length-s);for(var u,l,g=0,h=i.length,d=0;h>d;d++){var v=i[d],p=(v.angle,v.y);if(l=h-d,u=a>0?(o-p)/l:(p-c)/l,g=d,f>u){g=d+1;break}}if(g&&h-1>g){var m=g-1,b=i[m],p=b.y,x=a>0?o:c;l=h-m-1,u=Math.abs(x-p)/l,f>u&&(u=f);for(var d=h-1;d>=m;d--){var y=(h-1-d)*u;n(i[d],y,r,t,e)}for(var k=a>0?c:o,A=!1,d=m-1;d>0;d--){var I=i[d];if(!A&&Math.abs(k-I.y)/(d+1)<f&&(A=!0),A){var y=Math.abs(i[d+1].y-x)+f;n(i[d],y,r,t,e)}}}}var s=require("bui/common"),o=require("bui/chart/series/itemgroup"),c=require("bui/chart/activedgroup"),u=require("bui/graphic").Util,l=require("bui/chart/baseseries"),g=Math.PI/180,h=5,f=16,d=function(e){d.superclass.constructor.call(this,e)};return d.ATTRS={size:{value:"80%"},innerSize:{},center:{value:["50%","50%"]},colors:{},colorHighlight:{value:0},radius:{},startAngle:{value:-90},endAngle:{value:270},xField:{value:"name"},stickyTracking:{value:!1},animate:{value:!0},duration:{value:1e3}},s.extend(d,l),s.mixin(d,[o,c]),s.augment(d,{draw:function(e){function t(){i&&r.setSelected(i)}var i,r=this;s.each(e,function(e,t){r.formatPoint(e,t);var n=r.addItem(e,t);e.obj&&e.obj.selected&&(i=n)}),r.get("animate")?r.animateItems(t):t(),r.get("labelsGroup")&&(r.processLabels(e),r.get("labelsGroup").toFront())},changeShapes:function(e){var t=this;s.each(e,function(e,i){t.formatPoint(e,i)}),t.changePoints(e)},processLabels:function(e){var t=this,i=t.get("labelsGroup"),r=i.get("distance"),n=[],o=t.getCenter(),c=t.getRadius(),u=c+r,l=t.get("startAngle"),g=(t.get("endAngle"),[]);if(s.each(e,function(e){var a=t._getLabelCfg(e,r,u);0>r?i.addLabel(a):a.factor>0?g.push(a):n.push(a)}),n.length){var h;h=l>=-90?270:-90,a(o,u,n,h,-1),s.each(n,function(e){i.addLabel(e),t.lineToLabel(e,c,r)})}g.length&&(a(o,u,g,90,1),s.each(g,function(e){i.addLabel(e),t.lineToLabel(e,c,r)}))},resetLabels:function(){var e=this,t=e.get("labelsGroup"),i=e.get("lineGroup");t&&(t.clear(),i&&i.clear(),e.processLabels(e.getPoints()))},lineToLabel:function(e,t,i){var r,n=this,a=e.orignAngle||e.angle,s=n.getCenter(),o=n._getOffset(a,t+h/2),c=n.get("lineGroup"),u=[];u.push(["M",s.x+o.x,s.y+o.y]),null!=e.orignX?(r=n._getOffset(a,t+i/2),u.push(["R",s.x+r.x,s.y+r.y,e.x,e.y])):u.push(["L",e.x,e.y]),c||(c=n.addGroup(),n.set("lineGroup",c)),c.addShape("path",{path:u,fill:null,stroke:e.color})},bindUI:function(){d.superclass.bindUI.call(this),this.bindItemClick()},onMouseOver:function(){var e=this;e.on("mouseover",function(t){var i=t.target,r=i.shape;r&&e.setActivedItem(r)})},_getLabelCfg:function(e,t,i){var r=this,n=e.startAngle+(e.endAngle-e.startAngle)/2,a=r.getCenter(),s=a.x+(i+h)*Math.cos(n*g),o=a.y+(i+h)*Math.sin(n*g),c={},u=1;return c.x=s,c.y=o,0>t?n>-90&&90>=n?(c["text-anchor"]="end",c.rotate=n):(c["text-anchor"]="start",c.rotate=n-180):n>-90&&90>=n?(c["text-anchor"]="start",u=1):(u=-1,c["text-anchor"]="end"),c.factor=u,c.angle=n,c.color=e.color,c.point=e,c.text=e.xValue,c},getActiveItems:function(){return this.getItems()},setItemActived:function(e,t){var i=e.getCfgAttr("attrs").fill;t?(e.attr({fill:u.highlight(i,.1)}),e.set("actived",!0)):(e.attr({fill:i}),e.set("actived",!1))},getTrackingInfo:function(){var e=this,t=e.getActived();return t&&t.get("point")},isItemActived:function(e){return e.get("actived")},getRadius:function(){var e=this,t=e.get("radius");return t||(t=e.calculateRadius(e.get("size")),e.set("radius",t)),t},getInnerRadius:function(){var e=this,t=e.get("innerRadius"),i=e.get("innerSize");return!t&&i&&(t=e.calculateRadius(i),e.set("innerRadius",t)),t},calculateRadius:function(e){var t=this,r=t.get("parent").get("plotRange"),n=i(e);return Math.min(r.getWidth(),r.getHeight())/2*n},getCenter:function(){var i,r=this,n=r.get("centerPoint");return n||(n={},i=r.get("center"),n.x=e(r,i[0]),n.y=t(r,i[1]),r.set("centerPoint",n)),n},getItemCfg:function(e){var t=this,i=t.get("item"),r=e.obj,n={};return s.mix(n,i),r&&r.attrs&&s.mix(n,r.attrs),n.fill=e.color,t.get("allowPointSelect")&&(n.cursor="pointer"),n},_getColor:function(e){var t,i=this,r=i.get("colors"),n=i.get("colorHighlight");return e%=r.length,t=r[e],n&&(t=u.highlight(n)),t},formatPoint:function(e,t){var i=this,r=i.getVisiblePoints(),n=i._getPiePercent(e,r),a=i.get("startAngle"),s=i.get("endAngle"),o=s-a;e.percent=n.percent,e.obj&&e.obj.attrs&&(e.color=e.obj.attrs.fill),e.color=e.color||i._getColor(t),e.prePercent=n.prePercent,e.startAngle=a+o*n.prePercent,e.endAngle=a+o*(e.prePercent+e.percent)},getPointByValue:function(e,t){return{xValue:e,value:t}},_getPiePercent:function(e,t){var i=0,r=0,n=s.Array.indexOf(e,t),a={};return s.each(t,function(e,t){n>t&&(r+=e.value),i+=e.value}),a.percent=e.value/i,a.prePercent=r/i,a},getVisiblePoints:function(){var e=this;return e.getPoints()},animateItem:function(e,t){var i=this,r=e.get("point"),n=r.startAngle,a=r.endAngle,s=t==e.get("prePoint"),o=s?t.startAngle:t.endAngle,c=s?t.endAngle:t.endAngle,l=e.get("animHadler");l&&u.stopStep(l),l=u.animStep(i.get("changeDuration"),function(t){var r,u,l;if(s?(u=o+(n-o)*t,l=c+(a-c)*t):(u=o-(o-n)*t,l=c-(c-a)*t),r=i._getPiePath(u,l),e.attr("path",r),i.isSelected(e)){var g=i._getOffset(u,l,10);e.attr("transform","t"+g.x+" "+g.y)}}),e.set("animHadler",l)},pointToFactorPath:function(e,t){var i,r,n=this,a=n.get("startAngle");return i=e.startAngle,r=e.endAngle,n._getPiePath(a+(i-a)*t,a+(r-a)*t)},_getPiePath:function(e,t){var i,r=this,n=r.getCenter(),a=n.x,s=n.y,o=r.getRadius(),c=r.getInnerRadius(),u=a+o*Math.cos(e*g),l=a+o*Math.cos(t*g),h=s+o*Math.sin(e*g),f=s+o*Math.sin(t*g);if(c){var d=a+c*Math.cos(e*g),v=a+c*Math.cos(t*g),p=s+c*Math.sin(e*g),m=s+c*Math.sin(t*g);i=[],t-e==360?(i.push(["M",a,s-o]),i.push(["a",o,o,0,1,1,0,2*o]),i.push(["a",o,o,0,1,1,0,-2*o]),i.push(["M",a,s-c]),i.push(["a",c,c,0,1,0,0,2*c]),i.push(["a",c,c,0,1,0,0,-2*c]),i.push(["z"])):(i.push(["M",d,p]),i.push(["L",u,h]),i.push(["A",o,o,0,+(t-e>180),1,l,f]),i.push(["L",v,m]),i.push(["A",c,c,0,+(t-e>180),0,d,p]),i.push(["z"]))}else i=t-e==360?[["M",a,s-o],["a",o,o,0,1,1,0,2*o],["a",o,o,0,1,1,0,-2*o],["z"]]:["M",a,s,"L",u,h,"A",o,o,0,+(t-e>180),1,l,f,"z"];return i},_getOffset:function(e,t,i){var r,n={};return null==i?(r=e,i=t):r=e+(t-e)/2,n.x=i*Math.cos(r*g),n.y=i*Math.sin(r*g),n},setItemSelected:function(e,t){var i,r=this,n=e.get("point"),a=r.get("changeDuration");t?(i=r._getOffset(n.startAngle,n.endAngle,10),e.animate({transform:"t"+i.x+" "+i.y},a)):e.animate({transform:"t0 0"},a),e.set("selected",t)}}),d}),define("bui/chart/series",["bui/chart/baseseries","bui/chart/lineseries","bui/chart/areaseries","bui/chart/columnseries","bui/chart/scatterseries","bui/chart/bubbleseries","bui/chart/pieseries"],function(require){var e=require("bui/chart/baseseries");return e.Line=require("bui/chart/lineseries"),e.Area=require("bui/chart/areaseries"),e.Column=require("bui/chart/columnseries"),e.Scatter=require("bui/chart/scatterseries"),e.Bubble=require("bui/chart/bubbleseries"),e.Pie=require("bui/chart/pieseries"),e}),define("bui/chart/seriesgroup",["bui/common","bui/chart/plotitem","bui/chart/legend","bui/chart/activedgroup","bui/chart/series","bui/chart/tooltip","bui/chart/axis"],function(require){function e(e,t){return e>t?t:e}function t(e){t.superclass.constructor.call(this,e)}var i=require("bui/common"),r=require("bui/chart/activedgroup"),n=require("bui/chart/plotitem"),a=require("bui/chart/legend"),s=require("bui/chart/tooltip"),o=require("bui/chart/axis"),c=require("bui/chart/series"),u=120,l=80;return t.ATTRS={elCls:{value:"x-chart-series-group"},zIndex:{value:5},plotRange:{},colors:{value:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},symbols:{value:["circle","diamond","square","triangle","triangle-down"]},seriesOptions:{value:{}},series:{},legend:{},xAxis:{},yAxis:{},tooltip:{},stackedData:{},data:{},itemName:{value:"series"}},i.extend(t,n),i.mixin(t,[r]),i.augment(t,{renderUI:function(){var e=this;t.superclass.renderUI.call(e),e._renderLegend(),e._renderSeries(),e._renderAxis(),e._addSeriesAxis(),e._paintAxis(e.get("xAxis"),"xAxis"),e._paintAxis(e.get("yAxis"),"yAxis"),e._paintSeries(),e._renderTooltip()},bindUI:function(){var e=this;t.superclass.bindUI.call(e),e.bindCanvasEvent()},bindCanvasEvent:function(){function e(i){$.contains(n.get("node"),i.target)||n.get("node")==i.target||(t.onTriggerOut(i),$(document).off("click",e))}var t=this,r=t.get("tipGroup").get("triggerEvent"),n=t.get("canvas");"click"==r?n.on("click",function(i){t.onCanvasMove(i),setTimeout(function(){$(document).off("click",e).on("click",e)})}):(n.on("mousemove",i.wrapBehavior(t,"onCanvasMove")),n.on("mouseout",i.wrapBehavior(t,"onMouseOut")))},onCanvasMove:function(e){var t,i=this,r=i.get("canvas"),n=i.get("tipGroup");n&&(t=r.getPoint(e.pageX,e.pageY),i._isInAxis(t)?i._processTracking(t,n):i.onMouseOut())},onTriggerOut:function(){var e=this,t=e.get("tipGroup");e.clearActivedItem(),t.get("visible")&&(t.get("shared")&&i.each(e.getVisibleSeries(),function(e){var t=e.get("markersGroup");t&&t.clearActivedItem()}),e._hideTip())},onMouseOut:function(e){var t=this;e&&e.target!=t.get("canvas").get("none")||t.onTriggerOut(e)},getSeries:function(){return this.get("children")},_processTracking:function(e,t){var r,n=this,a=[];if(t.get("shared"))a=n.getSeries();else{var s=n.getActived();s&&a.push(s)}i.each(a,function(t){t&&t.get("stickyTracking")&&t.get("visible")&&t.onStickyTracking({point:e})}),a.length&&(r=n._getTipInfo(a,e),r.items.length&&n._showTooltip(r.title,r.point,r.items))},_getTipInfo:function(e,t){var r={items:[],point:{}},n=0,a=this.get("tipGroup").get("pointRenderer");return i.each(e,function(i){var s,o=i.getTrackingInfo(t),c={};if(o){if(i.get("visible")){n+=1,c.name=i.get("name"),c.value=a?a(o,i):i.getTipItem(o),c.color=o.color||i.get("color"),r.items.push(c);var u=i.get("markersGroup");if(u&&u.get("single")){var l=u.getChildAt(0);l&&l.attr({x:o.x,y:o.y})}}s=i.get("xAxis")?i.get("xAxis").formatPoint(o.xValue):o.xValue,1==n&&(r.title=s,o.x?(r.point.x=o.x,r.point.y=1==e.length?o.y:t.y):(r.point.x=t.x,r.point.y=t.y))}}),r},_showTooltip:function(e,t,i){var r=this,n=r.get("tipGroup"),a=r.get("prePoint");a&&a.x==t.x&&a.y==t.y||(n.setPosition(t.x,t.y),r.set("prePoint",t),n.get("visible")||n.show(),n.setTitle(e),n.setItems(i))},_hideTip:function(){var e=this,t=e.get("tipGroup");t&&t.get("visible")&&(t.hide(),e.set("prePoint",null))},_isInAxis:function(e){var t=this,i=t.get("plotRange");return i.isInRange(e)},_renderSeries:function(){var e=this,t=e.get("series");i.each(t,function(t,i){e.addSeries(t,i)})},_renderLegend:function(){var e,t=this,i=t.get("legend");i&&(i.items=i.items||[],i.plotRange=t.get("plotRange"),e=t.get("parent").addGroup(a,i),t.set("legendGroup",e))},_renderTooltip:function(){var e,t=this,i=t.get("tooltip");i&&(i.plotRange=t.get("plotRange"),e=t.get("parent").addGroup(s,i),t.set("tipGroup",e))},_renderAxis:function(){var e=this,t=e.get("xAxis"),r=e.get("yAxis");if(t&&!t.isGroup&&(t=e._createAxis(t),e.set("xAxis",t)),i.isArray(r)&&!r[0].isGroup){var n=[];i.each(r,function(t){n.push(e._createAxis(t)),e.set("yAxis",n)})}else r&&!r.isGroup&&(t&&"circle"==t.get("type")&&(r.type="radius",r.circle=t),r=e._createAxis(r),e.set("yAxis",r))},_createAxis:function(e){var t,r,n=this,a=e.type;return e.categories?a="category":e.ticks||"circle"==a||(e.autoTicks=!0),"category"!=a||e.categories||(e.autoTicks=!0),e.plotRange=n.get("plotRange"),e.autoPaint=!1,a=a||"number",r=i.ucfirst(a),t=o[r],t?n.get("parent").addGroup(t,e):null},_caculateAxisInfo:function(e,t){if("category"==e.get("type"))return this._caculateCategories(e,t);var i,r,n,a,s,c,g,h=this,f=[],d=e.get("type"),v=e.getLength(),p=Math.floor(v/u),m=Math.ceil(v/l);if("number"==d||"radius"==d)n=e.getCfgAttr("min"),a=e.getCfgAttr("max"),c=o.Auto;else if("time"==d){var b=e.get("startDate"),x=e.get("endDate");b&&(n=b.getTime()),x&&(a=x.getTime()),c=o.Auto.Time}s=e.getCfgAttr("tickInterval"),r=h.getSeries();var y={min:n,max:a,interval:s};return"yAxis"==t&&(y.maxCount=m,y.minCount=p,i=r[0].get("stackType")),f=i&&"none"!=i?h.getStackedData(e,t):h.getSeriesData(e,t),f.length?(y.data=f,g=c.caculate(y,i)):g={ticks:[]},g},_caculateCategories:function(e,t){var r=this,n=r.getSeriesData(e,t),a=[];if(n.length&&(a=a.concat(n[0])),n.length>1&&!r.get("data"))for(var s=1;s<n.length;s++){var o=n[s];i.each(o,function(e){i.indexOf(e)||a.push(e)})}return{categories:a}},getSeriesData:function(e,t){var r=this,n=[],a=r.getVisibleSeries();return e=e||r.get("yAxis"),t=t||"yAxis",i.each(a,function(i){if(i.get(t)==e){var r=i.getData(t);r.length&&n.push(r)}}),n},_parseData:function(e,t){var r=[];return i.each(t,function(t){r.push(e[t])}),r},getStackedData:function(t,r){var n,a,s=this;return stackedData=s.get("stackedData"),arr=[],stackedData?arr=stackedData:(n=s.getSeriesData(t,r),a=n[0],e=null,i.each(a,function(t,i){for(var r=t,a=1;a<n.length;a++){var s=n[a][i];r+=s,(null==e||e>s)&&(e=s)}arr.push(r)}),arr.push(e),s.set("stackedData",arr)),arr},_paintAxis:function(e,t){var r,n=this;r=i.isArray(e)?e:[e],i.each(r,function(e){if(n._hasRelativeSeries(e,t)){if(e.get("autoTicks")){var i=n._caculateAxisInfo(e,t);e.changeInfo(i)}e.paint()}})},_hasRelativeSeries:function(e,t){var r=this,n=r.getVisibleSeries(),a=!1;return i.each(n,function(i){return i.get(t)==e?(a=!0,!1):void 0}),a},_resetAxis:function(e,t){if(e.get("autoTicks")){t=t||"yAxis",this.set("stackedData",null);{var i=this,r=i._caculateAxisInfo(e,t);i.getSeries()}e.change(r)}},_resetSeries:function(){var e=this,t=e.getSeries();i.each(t,function(e){e.get("visible")&&e.repaint()})},repaint:function(){var e=this,t=e.get("xAxis"),r=e.get("yAxis");t&&e._resetAxis(t,"xAxis"),r&&(i.isArray(r)?i.each(r,function(t){e._resetAxis(t,"yAxis")}):e._resetAxis(r,"yAxis")),e._resetSeries()},changeData:function(e){var t=this,r=t.getSeries(),n=t.get("fields");t.set("data",e),i.each(r,function(i,r){if(n){var a=t._getSeriesData(i.get("name"),r);i.changeData(a)}else i.changeData(e)}),t.repaint()},_getSeriesData:function(e,t){var r=this,n=r.get("data"),a=r.get("fields"),s=n[t];return e&&i.each(n,function(t){return t.name==e?(s=t,!1):void 0}),r._parseData(s,a)},_getDefaultType:function(){var e=this,t=e.get("seriesOptions"),r="line";return i.each(t,function(e,t){return r=t.replace("Cfg",""),!1}),r},getVisibleSeries:function(){var e=this,t=e.getSeries();return i.Array.filter(t,function(e){return e.get("visible")})},addSeries:function(e,t){var i,r=this,n=e.type||r._getDefaultType(),a=r._getSeriesClass(n),s=r._getSeriesCfg(n,e,t);return s.autoPaint=s.autoPaint||!1,i=r.addGroup(a,s),r._addLegendItem(i),i},_paintSeries:function(){var e=this,t=e.getSeries();i.each(t,function(e){e.paint()})},_addSeriesAxis:function(){var e=this,t=e.getSeries();i.each(t,function(t){if("pie"==t.get("type"))return!0;t.get("xAxis")||t.set("xAxis",e.get("xAxis"));var r=e.get("yAxis");null==t.get("yAxis")&&(i.isArray(r)?t.set("yAxis",r[0]):t.set("yAxis",r)),i.isNumber(t.get("yAxis"))&&t.set("yAxis",r[t.get("yAxis")])})},showSeries:function(e){var t=this,i=t.get("yAxis");e.get("visible")||(e.show(),i&&(t._resetAxis(i),t._resetSeries()))},hideSeries:function(e){var t=this,i=t.get("yAxis");e.get("visible")&&(e.hide(),i&&(t._resetAxis(i),t._resetSeries()))},_addLegendItem:function(e){var t=this,i=t.get("legendGroup");i&&i.addItem({series:e})},_getSeriesCfg:function(e,t,r){var n=this,a=n.get("seriesOptions"),s=n.get("colors"),o=n.get("data"),c=n.get("fields"),u=n.get("symbols");return t=i.mix(!0,{},a[e+"Cfg"],t),!t.color&&s.length&&(t.color=s[r%s.length]),t.markers&&t.markers.marker&&!t.markers.marker.symbol&&(t.markers.marker.symbol=u[r%u.length]),o&&!t.data&&(t.data=c?n._getSeriesData(t.name,r):o),t},_getSeriesClass:function(e){var t=i.ucfirst(e),r=c[t]||c;return r},remove:function(){var e=this,r=e.get("canvas");r.off("mousemove",i.getWrapBehavior(e,"onCanvasMove")),r.off("mouseout",i.getWrapBehavior(e,"onMouseOut")),t.superclass.remove.call(e)}}),t}),define("bui/chart/chart",["bui/common","bui/graphic","bui/chart/plotback","bui/chart/theme","bui/chart/seriesgroup"],function(require){var e=require("bui/common"),t=require("bui/chart/plotback"),i=require("bui/graphic"),r=require("bui/chart/seriesgroup"),n=require("bui/chart/theme"),a=e.Component.Controller.extend([e.Component.UIBase.Bindable],{renderUI:function(){var e=this;e.paint()},clear:function(){var e=this,t=e.get("canvas");t.destroy(),e.set("isPaint",!1)},paint:function(){var e=this;e.get("isPaint")||(e._renderCanvas(),e._renderPlot(),e._renderTitle(),e._renderSeries(),e.get("canvas").sort())},_renderCanvas:function(){var e=this,t=e.get("el"),r=e.get("width")||t.width(),n=e.get("height")||t.height(),a=new i.Canvas({width:r,height:n,render:t});a.chart=e,e.set("canvas",a)},_renderPlot:function(){var i,r,n=this,a=n.get("plotCfg"),s=n.get("canvas"),o=n.get("theme");a=e.mix({},o.plotCfg,a),i=s.addGroup(t,a),r=i.get("plotRange"),n.set("plotRange",r)},_renderTitle:function(){var t=this,i=t.get("title"),r=t.get("subTitle"),n=t.get("theme"),a=t.get("canvas");i&&(null==i.x&&(i.x=a.get("width")/2,i.y=i.y||15),i=e.mix({},n.title,i),a.addShape("label",i)),r&&(null==r.x&&(r.x=a.get("width")/2,r.y=r.y||35),r=e.mix({},n.subTitle,r),a.addShape("label",r))},_getDefaultType:function(){var t=this,i=t.get("seriesOptions"),r="line";return e.each(i,function(e,t){return r=t.replace("Cfg",""),!1}),r},_renderSeries:function(){var t,i=this,n=i.get("theme"),a={},s=i.getAttrVals(),o=i._getDefaultType();e.each(s.series,function(e){e.type||(e.type=o)}),e.mix(!0,a,n,{colors:s.colors,data:s.data,fields:s.fields,plotRange:s.plotRange,series:s.series,seriesOptions:s.seriesOptions,tooltip:s.tooltip,legend:s.legend,xAxis:s.xAxis}),e.isObject(s.yAxis)?e.mix(!0,a,{yAxis:s.yAxis}):e.isArray(s.yAxis)&&(s.yAxis[0]=e.merge(!0,n.yAxis,s.yAxis[0]),a.yAxis=s.yAxis),t=i.get("canvas").addGroup(r,a),i.set("seriesGroup",t)},repaint:function(){var e=this;e.get("seriesGroup").repaint()},getSeries:function(){return this.get("seriesGroup").getSeries()},changeData:function(e){var t=this,i=t.get("seriesGroup");e!==t.get("data")&&t.set("data",e),i.changeData(e)},onLoad:function(){var e=this,t=e.get("store"),i=t.getResult();e.changeData(i)},onAdd:function(){this.onLoad()},onRemove:function(){this.onLoad()},onUpdate:function(){this.onLoad()},onLocalSort:function(){this.onLoad()},destructor:function(){var e=this;e.clear()}},{ATTRS:{canvas:{},colors:{},data:{},legend:{},menu:{},plotCfg:{},plotRange:{},series:{},seriesOptions:{},subTitle:{},title:{},tooltip:{},xAxis:{},yAxis:{},fields:{},theme:{value:n.Base}}},{xclass:"chart"});return a});