define("bui/module",["bui/common"],function(require){function e(){return"module"+n++}var t=require("bui/common"),n=1,i=function(t){i.superclass.constructor.call(this,t),this.get("id")||this.set("id",e()),this.get("autoInit")&&this.init(),i.Manager.add(this)};i.ATTRS={id:{},autoInit:{value:!1},hasInit:{value:!1},parent:{},destroyed:{value:!1},modules:{value:{},shared:!1},events:{value:["change"]}},t.extend(i,t.Base),t.augment(i,{set:function(e,t){this.setInternal?this.setInternal(e,t):i.superclass.set.call(this,e,t)},init:function(){return this.get("hasInit")||(this._initData(),this._initDom(),this._initModules(),this._initEvent(),this.set("hasInit",!0)),this},fire:function(e,t,n){n=void 0==n?!0:n;var s=$.makeArray(arguments),u=this,o=t;t&&t.module&&(u=t.module,o=t.event),i.superclass.fire.apply(this,s);var a=this.get("parent");a&&a.fire("change",{module:u,eventType:e,event:o},!1),n&&i.Manager.fire("change",{module:this,eventType:e,event:t})},addModule:function(e){e.set("parent",this),this.get("modules")[e.get("id")]=e},removeById:function(e){this.removeModule(this.getModule(e))},removeModule:function(e){delete this.get("modules")[e.get("id")]},getModule:function(e){return this.get("modules")[e]},eachModule:function(e){t.each(this.getModules(),e)},getModules:function(){return this.get("modules")},_initData:function(){},_initDom:function(){},_initModules:function(){},_initEvent:function(){},_destroy:function(){var e=this,n=e.get("modules");t.each(n,function(e){e.destroy()}),e.set("modules",null),e.detach()},destroy:function(){this.get("destroyed")||(i.Manager.remove(this),this._destroy(),this.set("destroyed",!0))}});var s={},u=function(){};return t.extend(u,t.Base),t.augment(u,{add:function(e){var t=e.get("id");s[t]=e},remove:function(e){var t=e.get("id");delete s[t]},getModule:function(e){return s[e]}}),i.Manager=new u,i});