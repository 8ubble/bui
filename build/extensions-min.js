define("bui/extensions",["bui/common","jquery","bui/tree","bui/list","bui/data","bui/grid","bui/mask","bui/toolbar","bui/menu","bui/picker","bui/overlay","bui/form"],function(e){e("bui/extensions/treegrid"),e("bui/extensions/treepicker"),e("bui/extensions/search"),e("bui/extensions/multiselect")}),define("bui/extensions/treegrid",["bui/common","jquery","bui/tree","bui/list","bui/data","bui/grid","bui/mask","bui/toolbar","bui/menu"],function(e,t,i){var n=(e("bui/common"),e("bui/tree")),r=e("bui/grid"),u=r.Grid.extend([n.Mixin],{},{ATTRS:{iconContainer:{value:".bui-grid-cell-inner"}}},{xclass:"tree-grid"});i.exports=u}),define("bui/extensions/treepicker",["bui/common","jquery","bui/picker","bui/overlay","bui/list","bui/data","bui/tree"],function(e,t,i){var n=e("bui/common"),r=e("bui/picker").ListPicker,u=(e("bui/tree"),r.extend({setSelectedValue:function(e){e=e||"";var t=this,i=t.get("tree");if(t.get("isInit")||t._initControl(),"selected"===t.get("selectStatus"))e&&i.expandNode(e),r.prototype.setSelectedValue.call(t,e);else{i.clearAllChecked();var u=e.split(",");n.each(u,function(e){i.setChecked(e)})}},getSelectedValue:function(){var e=this,t=e.get("tree");if("selected"===e.get("selectStatus"))return r.prototype.getSelectedValue.call(e);var i=t.getCheckedNodes();return i=e._getFilterNodes(i),n.Array.map(i,function(e){return e.id}).join(",")},getSelectedText:function(){var e=this,t=e.get("tree");if("selected"===e.get("selectStatus"))return r.prototype.getSelectedText.call(e);var i=t.getCheckedNodes();return i=e._getFilterNodes(i),n.Array.map(i,function(e){return e.text}).join(",")},_getFilterNodes:function(e){var t=this,i=t.get("filter");return i&&(e=n.Array.filter(e,i)),e}},{ATTRS:{defaultChildClass:{value:"tree-list"},selectStatus:{value:"selected"},changeEvent:{getter:function(){return this.get("selectStatus")+"change"}},hideEvent:{getter:function(e){return"checked"===this.get("selectStatus")?null:e}},filter:{},tree:{getter:function(){return this.get("children")[0]}}}},{xclass:"tree-picker"}));i.exports=u}),define("bui/extensions/search",["jquery","bui/common","bui/form","bui/overlay","bui/list","bui/data"],function(e,t,i){function n(e){n.superclass.constructor.call(this,e)}var r=e("jquery"),u=e("bui/common"),s=e("bui/form");u.extend(n,u.Base),n.ATTRS={tpl:{value:'<p><input type="text" name="key"/> <button class="button button-small">\u786e\u5b9a</button></p>'}},u.augment(n,{createDom:function(){var e=this,t=r("<div></div>").append(e.get("tpl")),i=new s.Group({srcNode:t}).render();e.set("el",t),e.set("group",i)},renderUI:function(e){var t=e.get("el");t.before(this.get("el"))},bindUI:function(e){var t=this,i=t.get("el"),n=e.get("store"),r=t.get("group");i.find(".button").on("click",function(){n.load(r.getRecord())})}}),i.exports=n}),define("bui/extensions/multiselect",["bui/common","jquery","bui/form","bui/overlay","bui/list","bui/data","bui/picker"],function(e,t,i){var n=(e("bui/common"),e("bui/extensions/search"),e("bui/extensions/multiselect/multilist"),e("bui/extensions/multiselect/multilistpicker"),e("bui/extensions/multiselect/multiselect"));i.exports=n}),define("bui/extensions/multiselect/multilist",["jquery","bui/common","bui/list","bui/data"],function(e,t,i){function n(e,t,i){u.isFunction(e.set)?e.set(t,i):e[t]=i}var r=e("jquery"),u=e("bui/common"),s=u.Component,l=(e("bui/list"),u.prefix),o=l+"multilist-source",c=l+"multilist-target",a=l+"multilist-btn-right",d=l+"multilist-btn-left",m=s.Controller.extend({renderUI:function(){var e=this,t=e.get("source"),i=e.get("target");t=e._initControl(t,o),i=e._initControl(i,c),t.render(),i.render(),e.set("source",t),e.set("target",i)},_initControl:function(e,t){var i=this,n=i.get("el");return e.isController?(e.set("render",n.find("."+t)),e):(e.render=n.find("."+t),i._createControl(e))},_createControl:function(e){if(e.isController)return e;var t=e.multipleSelect||this.get("multipleSelect"),i=e.xclass||t?"listbox":"simple-list";return e.xclass=i,s.create(e,this)},bindUI:function(){var e=this,t=e.get("el"),i=e.get("source"),n=e.get("target"),u=t.find("."+a),s=t.find("."+d);u.on("click",function(){var t=i.getSelection();e.fire("selected",{items:t})!==!1&&(i.removeItems(t),n.addItems(t))}),s.on("click",function(){var t=n.getSelection();e.fire("unselected",{items:t})!==!1&&(n.removeItems(t),i.addItems(t))}),i.on("dblclick",function(t){var u=r(t.domTarget).closest("li"),s=i.getItemByElement(u);e.fire("selected",{items:[s]})!==!1&&(i.removeItem(s),n.addItem(s))}),n.on("dblclick",function(t){var u=r(t.domTarget).closest("li"),s=n.getItemByElement(u);e.fire("unselected",{items:[s]})!==!1&&(n.removeItem(s),i.addItem(s))})},_uiSetStore:function(e){var t=this,i=t.get("target"),n=i.get("idField");e.filter(function(e){var t=i.getItems(),r=!0;return u.each(t,function(t){return t[n]===e[n]?(r=!1,!1):void 0}),r})}},{ATTRS:{source:{value:{elCls:"bui-select-list"},shared:!1},target:{value:{elCls:"bui-select-list"},shared:!1},store:{setter:function(e){return n(this.get("source"),"store",e),e}},items:{setter:function(e){var t=new u.Data.Store({data:e});return this.set("store",t),e}},url:{setter:function(e){if(e){var t=new u.Data.Store({url:e,autoLoad:!0});return this.set("store",t),e}}},tpl:{value:'<div class="row"><div class="span5 '+o+'"></div><div class="span2 bui-multilist-action centered"><p><button  class="button button-small '+a+'" type="button">&gt;&gt;</button></p><p><button  class="button button-small '+d+'" type="button">&lt;&lt;</button></p></div><div class="span5 '+c+'"></div></div>'}}},{xclass:"multilist"});i.exports=m}),define("bui/extensions/multiselect/multilistpicker",["jquery","bui/overlay","bui/common","bui/picker","bui/list","bui/data"],function(e,t,i){var n=e("jquery"),r=e("bui/overlay").Dialog,u=e("bui/picker").Mixin,s=r.extend([u],{setSelectedValue:function(e){function t(){i._syncValue(e),r.off("load",t)}var i=this,n=i.get("innerControl"),r=n.get("store");!this.get("isInit")&&e&&(e=e.split(","),r.get("url")?r.on("load",t):i._syncValue(e))},_syncValue:function(e){var t=this,i=t.get("innerControl"),r=t._getTextField(),u=i.get("source").get("idField"),s=i.get("store"),l=s.getResult(),o=[],c=[];BUI.each(l,function(t){-1!==n.inArray(t[u],e)&&(o.push(t),c.push(t.text))}),n(r).val(c.join(",")),BUI.each(o,function(e){s.remove(e)}),i.get("target").setItems(o)},getSelectedValue:function(){var e=this,t=e.get("innerControl"),i=t.get("target");return e._getItemsValue(i)},getSelectedText:function(){var e=this,t=e.get("innerControl"),i=t.get("target");return e._getItemsText(i)},_getItemsText:function(e,t){return t||(t=e.get("items")),n.map(t,function(t){return e.getItemText(t)})},_getItemsValue:function(e,t){var i=e.get("idField");return t||(t=e.get("items")),n.map(t,function(t){return e.getValueByField(t,i)})}},{ATTRS:{success:{value:function(){var e=this;e.get("innerControl").fire(e.get("changeEvent")),this.close()}}}},{xclass:"multilist-picker"});i.exports=s}),define("bui/extensions/multiselect/multiselect",["jquery","bui/common","bui/list","bui/data","bui/overlay","bui/picker","bui/form"],function(e,t,i){var n=e("jquery"),r=e("bui/common"),u=r.Component,s=e("bui/extensions/multiselect/multilist"),l=e("bui/extensions/multiselect/multilistpicker"),o=e("bui/extensions/search"),c=r.prefix+"select-input",a=u.Controller.extend({initializer:function(){var e,t=this,i=t.get("search"),n=t.get("searchTpl"),r={};i&&(n&&(r.tpl=n),i=new o(r),e=[i]);var u=new s({items:t.get("items"),url:t.get("url"),plugins:e});t.set("multilist",u)},renderUI:function(){var e=this,t=e.get("el"),i=t.find("."+c),n=e.get("multilist"),r=new l({trigger:i,autoRender:!0,textField:i,valueField:e.get("valueField"),children:[n]});e.set("picker",r),e.set("textField",i)},bindUI:function(){var e=this,t=e.get("multilist");t.on("selected",function(t){var i=t.items;return e.fire("selected",{items:i})}),t.on("unselected",function(t){var i=t.items;return e.fire("unselected",{items:i})})}},{ATTRS:{elCls:{value:"bui-select"},searchTpl:{},search:{},url:{},items:{},source:{getter:function(){return this.get("multilist").get("source")}},target:{getter:function(){return this.get("multilist").get("target")}},valueField:{setter:function(e){return n(e)}},textField:{},tpl:{view:!0,value:'<input type="text" readonly="readonly" class="'+c+'"/><span class="x-icon x-icon-normal"><i class="icon icon-caret icon-caret-down"></i></span>'}}},{xclass:"multiselect"});i.exports=a});