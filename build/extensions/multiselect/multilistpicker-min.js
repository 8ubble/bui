define("bui/extensions/multiselect/multilistpicker",["bui/overlay","bui/picker"],function(require){var e=require("bui/overlay").Dialog,t=require("bui/picker").Mixin,n=e.extend([t],{setSelectedValue:function(e){function t(){n._syncValue(e),r.off("load",t)}var n=this,i=n.get("innerControl"),r=i.get("store");!this.get("isInit")&&e&&(e=e.split(","),r.get("url")?r.on("load",t):n._syncValue(e))},_syncValue:function(e){var t=this,n=t.get("innerControl"),i=t._getTextField(),r=n.get("source").get("idField"),u=n.get("store"),l=u.getResult(),s=[],o=[];BUI.each(l,function(t){-1!==$.inArray(t[r],e)&&(s.push(t),o.push(t.text))}),$(i).val(o.join(",")),BUI.each(s,function(e){u.remove(e)}),n.get("target").setItems(s)},getSelectedValue:function(){var e=this,t=e.get("innerControl"),n=t.get("target");return e._getItemsValue(n)},getSelectedText:function(){var e=this,t=e.get("innerControl"),n=t.get("target");return e._getItemsText(n)},_getItemsText:function(e,t){return t||(t=e.get("items")),$.map(t,function(t){return e.getItemText(t)})},_getItemsValue:function(e,t){var n=e.get("idField");return t||(t=e.get("items")),$.map(t,function(t){return e.getValueByField(t,n)})}},{ATTRS:{success:{value:function(){var e=this;e.get("innerControl").fire(e.get("changeEvent")),this.close()}}}},{xclass:"multilist-picker"});return n});