define("bui/extensions/multiselect/multilist",["bui/common","bui/list"],function(require){function e(e,i,n){t.isFunction(e.set)?e.set(i,n):e[i]=n}var t=require("bui/common"),i=t.Component,n=(require("bui/list"),t.prefix),s=n+"multilist-source",l=n+"multilist-target",r=n+"multilist-btn-right",u=n+"multilist-btn-left",o=i.Controller.extend({renderUI:function(){var e=this,t=e.get("source"),i=e.get("target");t=e._initControl(t,s),i=e._initControl(i,l),t.render(),i.render(),e.set("source",t),e.set("target",i)},_initControl:function(e,t){var i=this,n=i.get("el");return e.isController?(e.set("render",n.find("."+t)),e):(e.render=n.find("."+t),i._createControl(e))},_createControl:function(e){if(e.isController)return e;var t=e.multipleSelect||this.get("multipleSelect"),n=e.xclass||t?"listbox":"simple-list";return e.xclass=n,i.create(e,this)},bindUI:function(){var e=this,t=e.get("el"),i=e.get("source"),n=e.get("target"),s=t.find("."+r),l=t.find("."+u);s.on("click",function(){var t=i.getSelection();e.fire("selected",{items:t})!==!1&&(i.removeItems(t),n.addItems(t))}),l.on("click",function(){var t=n.getSelection();e.fire("unselected",{items:t})!==!1&&(n.removeItems(t),i.addItems(t))}),i.on("dblclick",function(t){var s=$(t.domTarget).closest("li"),l=i.getItemByElement(s);e.fire("selected",{items:[l]})!==!1&&(i.removeItem(l),n.addItem(l))}),n.on("dblclick",function(t){var s=$(t.domTarget).closest("li"),l=n.getItemByElement(s);e.fire("unselected",{items:[l]})!==!1&&(n.removeItem(l),i.addItem(l))})},_uiSetStore:function(e){var i=this,n=i.get("target"),s=n.get("idField");e.filter(function(e){var i=n.getItems(),l=!0;return t.each(i,function(t){return t[s]===e[s]?(l=!1,!1):void 0}),l})}},{ATTRS:{source:{value:{elCls:"bui-select-list"},shared:!1},target:{value:{elCls:"bui-select-list"},shared:!1},store:{setter:function(t){return e(this.get("source"),"store",t),t}},items:{setter:function(e){var i=new t.Data.Store({data:e});return this.set("store",i),e}},url:{setter:function(e){if(e){var i=new t.Data.Store({url:e,autoLoad:!0});return this.set("store",i),e}}},tpl:{value:'<div class="row"><div class="span5 '+s+'"></div><div class="span2 bui-multilist-action centered"><p><button  class="button button-small '+r+'" type="button">&gt;&gt;</button></p><p><button  class="button button-small '+u+'" type="button">&lt;&lt;</button></p></div><div class="span5 '+l+'"></div></div>'}}},{xclass:"multilist"});return o}),define("bui/extensions/multiselect/multilistpicker",["bui/overlay","bui/picker"],function(require){var e=require("bui/overlay").Dialog,t=require("bui/picker").Mixin,i=e.extend([t],{setSelectedValue:function(e){function t(){i._syncValue(e),s.off("load",t)}var i=this,n=i.get("innerControl"),s=n.get("store");!this.get("isInit")&&e&&(e=e.split(","),s.get("url")?s.on("load",t):i._syncValue(e))},_syncValue:function(e){var t=this,i=t.get("innerControl"),n=t._getTextField(),s=i.get("source").get("idField"),l=i.get("store"),r=l.getResult(),u=[],o=[];BUI.each(r,function(t){-1!==$.inArray(t[s],e)&&(u.push(t),o.push(t.text))}),$(n).val(o.join(",")),BUI.each(u,function(e){l.remove(e)}),i.get("target").setItems(u)},getSelectedValue:function(){var e=this,t=e.get("innerControl"),i=t.get("target");return e._getItemsValue(i)},getSelectedText:function(){var e=this,t=e.get("innerControl"),i=t.get("target");return e._getItemsText(i)},_getItemsText:function(e,t){return t||(t=e.get("items")),$.map(t,function(t){return e.getItemText(t)})},_getItemsValue:function(e,t){var i=e.get("idField");return t||(t=e.get("items")),$.map(t,function(t){return e.getValueByField(t,i)})}},{ATTRS:{success:{value:function(){var e=this;e.get("innerControl").fire(e.get("changeEvent")),this.close()}}}},{xclass:"multilist-picker"});return i}),define("bui/extensions/multiselect/multiselect",["bui/common","bui/extensions/multiselect/multilist","bui/extensions/multiselect/multilistpicker","bui/extensions/search"],function(require){var e=require("bui/common"),t=e.Component,i=require("bui/extensions/multiselect/multilist"),n=require("bui/extensions/multiselect/multilistpicker"),s=require("bui/extensions/search"),l=e.prefix+"select-input",r=t.Controller.extend({initializer:function(){var e,t=this,n=t.get("search"),l=t.get("searchTpl"),r={};n&&(l&&(r.tpl=l),n=new s(r),e=[n]);var u=new i({items:t.get("items"),url:t.get("url"),plugins:e});t.set("multilist",u)},renderUI:function(){var e=this,t=e.get("el"),i=t.find("."+l),s=e.get("multilist"),r=new n({trigger:i,autoRender:!0,textField:i,valueField:e.get("valueField"),children:[s]});e.set("picker",r),e.set("textField",i)},bindUI:function(){var e=this,t=e.get("multilist");t.on("selected",function(t){var i=t.items;return e.fire("selected",{items:i})}),t.on("unselected",function(t){var i=t.items;return e.fire("unselected",{items:i})})}},{ATTRS:{elCls:{value:"bui-select"},searchTpl:{},search:{},url:{},items:{},source:{getter:function(){return this.get("multilist").get("source")}},target:{getter:function(){return this.get("multilist").get("target")}},valueField:{setter:function(e){return $(e)}},textField:{},tpl:{view:!0,value:'<input type="text" readonly="readonly" class="'+l+'"/><span class="x-icon x-icon-normal"><i class="icon icon-caret icon-caret-down"></i></span>'}}},{xclass:"multiselect"});return r}),define("bui/extensions/multiselect",["bui/common","bui/extensions/multiselect/multilist","bui/extensions/multiselect/multilistpicker","bui/extensions/multiselect/multiselect","bui/extensions/search"],function(require){var e=(require("bui/common"),require("bui/extensions/multiselect/multiselect"));return e});